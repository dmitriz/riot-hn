{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/index.js","src/filters.js","src/app.html","node_modules/riot/riot.js","src/views/user-view.html","src/views/item-view.html","src/views/news-view.html","src/store.js","src/components/item.html","src/components/comment.html","node_modules/browserify/node_modules/events/events.js"],"names":["require","mount","parser","document","createElement","filters","fromNow","time","between","Date","now","Number","domain","url","href","hostname","riot","tag","opts","self","this","currentView","loadView","viewName","id","unmount","data","bind","studyRoute","view","route","on","exec","window","undefined","loopKeys","expr","b0","brackets","els","slice","length","match","key","pos","val","mkitem","item","_each","dom","parent","remAttr","checksum","tagName","getTagName","template","outerHTML","hasImpl","tagImpl","impl","tmpl","root","parentNode","placeholder","createComment","tags","child","getTag","insertBefore","one","stub","removeChild","items","isArray","JSON","stringify","Object","keys","map","frag","createDocumentFragment","i","j","splice","_item","update","Tag","isLoop","cloneNode","innerHTML","appendChild","walk","node","nodeType","_looped","_visited","setNamed","parseNamedElements","childTags","getAttribute","cachedTag","ptag","push","parseExpressions","expressions","addExpr","extra","indexOf","extend","type","nodeValue","attr","each","attributes","name","bool","split","value","conf","updateOpts","ctx","el","normalizeData","T_UNDEF","inheritFromParent","k","mustSync","propsInSyncWithParent","toggle","isMount","evt","loopDom","observable","inherit","mkdom","cleanUpData","fn","toLowerCase","TAG_ATTRIBUTES","_tag","isMounted","attrs","a","kv","setAttribute","replace","_id","fastAbs","getTime","Math","random","test","replaceYield","T_OBJECT","trigger","mixin","arguments","mix","T_STRING","isFunction","init","call","firstChild","isInStub","keepRootTag","p","off","setEventHandler","handler","e","event","currentTarget","target","srcElement","which","charCode","keyCode","ignored","preventDefault","returnValue","preventUpdate","insertTo","before","attrName","toString","inStub","createTextNode","style","display","len","v","removeAttribute","nr","RIOT_TAG","namedTag","src","obj","args","o","blackList","checkie","ieVersion","matches","rootTag","mkEl","optgroupInnerHTML","optionInnerHTML","tbodyInnerHTML","nextSibling","$$","selector","querySelectorAll","$","querySelector","Child","prototype","html","div","loops","opt","valRegx","selRegx","eachRegx","ifRegx","innerRegx","valuesMatch","selectedMatch","innerValue","eachMatch","ifMatch","labelRegx","elementRegx","tagRegx","labelMatch","elementMatch","tagMatch","innerContent","options","trim","innerOpt","injectStyle","css","styleNode","head","styleSheet","cssText","_rendered","body","rs","mountTo","_innerHTML","virtualDom","version","settings","Array","_ts","win","documentMode","callbacks","events","typed","cb","arr","apply","fns","busy","concat","all","mixins","hash","loc","path","emit","current","location","started","r","arg","stop","removeEventListener","detachEvent","start","addEventListener","attachEvent","orig","cachedBrackets","b","re","x","s","RegExp","source","global","extract","Function","join","n","pair","_","wrap","nonull","reVars","str","substrings","parts","sub","open","close","level","cache","addRiotTags","list","selectAllTags","pushTags","allTags","nodeList","_el","util","exports","module","define","amd","store","fetchUser","user","about","fetchComments","fetchItems","kids","comments","fetchPollOptions","pollOptions","fetchItem","page","fetchNews","fetchItemsByPage","displayPage","removeListener","api","Firebase","storiesPerPage","cachedStoryIds","Emitter","EventEmitter","snapshot","once","ids","addItem","forEach","end","itemdata","showInfo","showDomain","commentcontent","text","result","_events","_maxListeners","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","isNaN","TypeError","er","listeners","error","Error","addListener","listener","m","newListener","warned","console","trace","g","fired","position","removeAllListeners","ret","listenerCount","emitter"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","require('./filters.js')\nrequire('./app.html')\nrequire('riot').mount('app')\n","var parser = document.createElement('a')\n\nfilters = {\n  fromNow: function(time) {\n    var between = Date.now() / 1000 - Number(time)\n    if (between < 3600) {\n      return ~~(between / 60) + ' minutes'\n    } else if (between < 86400) {\n      return ~~(between / 3600) + ' hours'\n    } else {\n      return ~~(between / 86400) + ' days'\n    }\n  },\n  domain: function(url) {\n    parser.href = url\n    return parser.hostname\n  }\n}\n","var riot = require('riot');\nriot.tag('app', '<div id=\"header\"> <a id=\"yc\" href=\"http://www.ycombinator.com\"> <img src=\"https://news.ycombinator.com/y18.gif\"> </a> <h1><a href=\"#\">Hacker News</a></h1> <span class=\"source\"> Built with <a href=\"https://muut.com/riotjs/\" target=\"_blank\">Riot.js</a> | <a href=\"https://github.com/txchen/riot-hn\" target=\"_blank\">Source</a> </span> </div> <div id=\"hnview\"></div>', function(opts) {\n  var self = this\n  self.currentView = null\n\n  this.loadView = function(viewName, id) {\n    if (self.currentView) {\n      self.currentView.unmount(true)\n    }\n    self.currentView = riot.mount('div#hnview', viewName, {data: id})[0]\n  }.bind(this);\n\n  this.studyRoute = function(view, id) {\n    switch(view) {\n    case 'user':\n      require('./views/user-view.html')\n      self.loadView('user-view', id)\n      break\n    case 'item':\n      require('./views/item-view.html')\n      self.loadView('item-view', id)\n      break\n    case 'news':\n      require('./views/news-view.html')\n      self.loadView('news-view', id)\n      break\n    default:\n      riot.route('news/1')\n    }\n  }.bind(this);\n  riot.route(self.studyRoute)\n  this.on('mount', function() {\n    riot.route.exec(self.studyRoute)\n  })\n  \n});\n","/* Riot v2.2.2, @license MIT, (c) 2015 Muut Inc. + contributors */\n\n;(function(window, undefined) {\n  'use strict'\n  var riot = { version: 'v2.2.2', settings: {} }\n\n  // This globals 'const' helps code size reduction\n\n  // for typeof == '' comparisons\n  var T_STRING = 'string',\n      T_OBJECT = 'object',\n      T_UNDEF  = 'undefined'\n\n  // for IE8 and rest of the world\n  /* istanbul ignore next */\n  var isArray = Array.isArray || (function () {\n    var _ts = Object.prototype.toString\n    return function (v) { return _ts.call(v) === '[object Array]' }\n  })()\n\n  // Version# for IE 8-11, 0 for others\n  var ieVersion = (function (win) {\n    return (window && window.document || {}).documentMode | 0\n  })()\n\nriot.observable = function(el) {\n\n  el = el || {}\n\n  var callbacks = {},\n      _id = 0\n\n  el.on = function(events, fn) {\n    if (isFunction(fn)) {\n      if (typeof fn.id === T_UNDEF) fn._id = _id++\n\n      events.replace(/\\S+/g, function(name, pos) {\n        (callbacks[name] = callbacks[name] || []).push(fn)\n        fn.typed = pos > 0\n      })\n    }\n    return el\n  }\n\n  el.off = function(events, fn) {\n    if (events == '*') callbacks = {}\n    else {\n      events.replace(/\\S+/g, function(name) {\n        if (fn) {\n          var arr = callbacks[name]\n          for (var i = 0, cb; (cb = arr && arr[i]); ++i) {\n            if (cb._id == fn._id) arr.splice(i--, 1)\n          }\n        } else {\n          callbacks[name] = []\n        }\n      })\n    }\n    return el\n  }\n\n  // only single event supported\n  el.one = function(name, fn) {\n    function on() {\n      el.off(name, on)\n      fn.apply(el, arguments)\n    }\n    return el.on(name, on)\n  }\n\n  el.trigger = function(name) {\n    var args = [].slice.call(arguments, 1),\n        fns = callbacks[name] || []\n\n    for (var i = 0, fn; (fn = fns[i]); ++i) {\n      if (!fn.busy) {\n        fn.busy = 1\n        fn.apply(el, fn.typed ? [name].concat(args) : args)\n        if (fns[i] !== fn) { i-- }\n        fn.busy = 0\n      }\n    }\n\n    if (callbacks.all && name != 'all') {\n      el.trigger.apply(el, ['all', name].concat(args))\n    }\n\n    return el\n  }\n\n  return el\n\n}\nriot.mixin = (function() {\n  var mixins = {}\n\n  return function(name, mixin) {\n    if (!mixin) return mixins[name]\n    mixins[name] = mixin\n  }\n\n})()\n\n;(function(riot, evt, win) {\n\n  // browsers only\n  if (!win) return\n\n  var loc = win.location,\n      fns = riot.observable(),\n      started = false,\n      current\n\n  function hash() {\n    return loc.href.split('#')[1] || ''\n  }\n\n  function parser(path) {\n    return path.split('/')\n  }\n\n  function emit(path) {\n    if (path.type) path = hash()\n\n    if (path != current) {\n      fns.trigger.apply(null, ['H'].concat(parser(path)))\n      current = path\n    }\n  }\n\n  var r = riot.route = function(arg) {\n    // string\n    if (arg[0]) {\n      loc.hash = arg\n      emit(arg)\n\n    // function\n    } else {\n      fns.on('H', arg)\n    }\n  }\n\n  r.exec = function(fn) {\n    fn.apply(null, parser(hash()))\n  }\n\n  r.parser = function(fn) {\n    parser = fn\n  }\n\n  r.stop = function () {\n    if (!started) return\n    win.removeEventListener ? win.removeEventListener(evt, emit, false) : win.detachEvent('on' + evt, emit)\n    fns.off('*')\n    started = false\n  }\n\n  r.start = function () {\n    if (started) return\n    win.addEventListener ? win.addEventListener(evt, emit, false) : win.attachEvent('on' + evt, emit)\n    started = true\n  }\n\n  // autostart the router\n  r.start()\n\n})(riot, 'hashchange', window)\n/*\n\n//// How it works?\n\n\nThree ways:\n\n1. Expressions: tmpl('{ value }', data).\n   Returns the result of evaluated expression as a raw object.\n\n2. Templates: tmpl('Hi { name } { surname }', data).\n   Returns a string with evaluated expressions.\n\n3. Filters: tmpl('{ show: !done, highlight: active }', data).\n   Returns a space separated list of trueish keys (mainly\n   used for setting html classes), e.g. \"show highlight\".\n\n\n// Template examples\n\ntmpl('{ title || \"Untitled\" }', data)\ntmpl('Results are { results ? \"ready\" : \"loading\" }', data)\ntmpl('Today is { new Date() }', data)\ntmpl('{ message.length > 140 && \"Message is too long\" }', data)\ntmpl('This item got { Math.round(rating) } stars', data)\ntmpl('<h1>{ title }</h1>{ body }', data)\n\n\n// Falsy expressions in templates\n\nIn templates (as opposed to single expressions) all falsy values\nexcept zero (undefined/null/false) will default to empty string:\n\ntmpl('{ undefined } - { false } - { null } - { 0 }', {})\n// will return: \" - - - 0\"\n\n*/\n\n\nvar brackets = (function(orig) {\n\n  var cachedBrackets,\n      r,\n      b,\n      re = /[{}]/g\n\n  return function(x) {\n\n    // make sure we use the current setting\n    var s = riot.settings.brackets || orig\n\n    // recreate cached vars if needed\n    if (cachedBrackets !== s) {\n      cachedBrackets = s\n      b = s.split(' ')\n      r = b.map(function (e) { return e.replace(/(?=.)/g, '\\\\') })\n    }\n\n    // if regexp given, rewrite it with current brackets (only if differ from default)\n    return x instanceof RegExp ? (\n        s === orig ? x :\n        new RegExp(x.source.replace(re, function(b) { return r[~~(b === '}')] }), x.global ? 'g' : '')\n      ) :\n      // else, get specific bracket\n      b[x]\n  }\n})('{ }')\n\n\nvar tmpl = (function() {\n\n  var cache = {},\n      reVars = /(['\"\\/]).*?[^\\\\]\\1|\\.\\w*|\\w*:|\\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\\b|function *\\()|([a-z_$]\\w*)/gi\n              // [ 1               ][ 2  ][ 3 ][ 4                                                                                  ][ 5       ]\n              // find variable names:\n              // 1. skip quoted strings and regexps: \"a b\", 'a b', 'a \\'b\\'', /a b/\n              // 2. skip object properties: .name\n              // 3. skip object literals: name:\n              // 4. skip javascript keywords\n              // 5. match var name\n\n  // build a template (or get it from cache), render with data\n  return function(str, data) {\n    return str && (cache[str] = cache[str] || tmpl(str))(data)\n  }\n\n\n  // create a template instance\n\n  function tmpl(s, p) {\n\n    // default template string to {}\n    s = (s || (brackets(0) + brackets(1)))\n\n      // temporarily convert \\{ and \\} to a non-character\n      .replace(brackets(/\\\\{/g), '\\uFFF0')\n      .replace(brackets(/\\\\}/g), '\\uFFF1')\n\n    // split string to expression and non-expresion parts\n    p = split(s, extract(s, brackets(/{/), brackets(/}/)))\n\n    return new Function('d', 'return ' + (\n\n      // is it a single expression or a template? i.e. {x} or <b>{x}</b>\n      !p[0] && !p[2] && !p[3]\n\n        // if expression, evaluate it\n        ? expr(p[1])\n\n        // if template, evaluate all expressions in it\n        : '[' + p.map(function(s, i) {\n\n            // is it an expression or a string (every second part is an expression)\n          return i % 2\n\n              // evaluate the expressions\n              ? expr(s, true)\n\n              // process string parts of the template:\n              : '\"' + s\n\n                  // preserve new lines\n                  .replace(/\\n/g, '\\\\n')\n\n                  // escape quotes\n                  .replace(/\"/g, '\\\\\"')\n\n                + '\"'\n\n        }).join(',') + '].join(\"\")'\n      )\n\n      // bring escaped { and } back\n      .replace(/\\uFFF0/g, brackets(0))\n      .replace(/\\uFFF1/g, brackets(1))\n\n    + ';')\n\n  }\n\n\n  // parse { ... } expression\n\n  function expr(s, n) {\n    s = s\n\n      // convert new lines to spaces\n      .replace(/\\n/g, ' ')\n\n      // trim whitespace, brackets, strip comments\n      .replace(brackets(/^[{ ]+|[ }]+$|\\/\\*.+?\\*\\//g), '')\n\n    // is it an object literal? i.e. { key : value }\n    return /^\\s*[\\w- \"']+ *:/.test(s)\n\n      // if object literal, return trueish keys\n      // e.g.: { show: isOpen(), done: item.done } -> \"show done\"\n      ? '[' +\n\n          // extract key:val pairs, ignoring any nested objects\n          extract(s,\n\n              // name part: name:, \"name\":, 'name':, name :\n              /[\"' ]*[\\w- ]+[\"' ]*:/,\n\n              // expression part: everything upto a comma followed by a name (see above) or end of line\n              /,(?=[\"' ]*[\\w- ]+[\"' ]*:)|}|$/\n              ).map(function(pair) {\n\n                // get key, val parts\n                return pair.replace(/^[ \"']*(.+?)[ \"']*: *(.+?),? *$/, function(_, k, v) {\n\n                  // wrap all conditional parts to ignore errors\n                  return v.replace(/[^&|=!><]+/g, wrap) + '?\"' + k + '\":\"\",'\n\n                })\n\n              }).join('')\n\n        + '].join(\" \").trim()'\n\n      // if js expression, evaluate as javascript\n      : wrap(s, n)\n\n  }\n\n\n  // execute js w/o breaking on errors or undefined vars\n\n  function wrap(s, nonull) {\n    s = s.trim()\n    return !s ? '' : '(function(v){try{v='\n\n        // prefix vars (name => data.name)\n        + (s.replace(reVars, function(s, _, v) { return v ? '(d.'+v+'===undefined?'+(typeof window == 'undefined' ? 'global.' : 'window.')+v+':d.'+v+')' : s })\n\n          // break the expression if its empty (resulting in undefined value)\n          || 'x')\n      + '}catch(e){'\n      + '}finally{return '\n\n        // default to empty string for falsy values except zero\n        + (nonull === true ? '!v&&v!==0?\"\":v' : 'v')\n\n      + '}}).call(d)'\n  }\n\n\n  // split string by an array of substrings\n\n  function split(str, substrings) {\n    var parts = []\n    substrings.map(function(sub, i) {\n\n      // push matched expression and part before it\n      i = str.indexOf(sub)\n      parts.push(str.slice(0, i), sub)\n      str = str.slice(i + sub.length)\n    })\n\n    // push the remaining part\n    return parts.concat(str)\n  }\n\n\n  // match strings between opening and closing regexp, skipping any inner/nested matches\n\n  function extract(str, open, close) {\n\n    var start,\n        level = 0,\n        matches = [],\n        re = new RegExp('('+open.source+')|('+close.source+')', 'g')\n\n    str.replace(re, function(_, open, close, pos) {\n\n      // if outer inner bracket, mark position\n      if (!level && open) start = pos\n\n      // in(de)crease bracket level\n      level += open ? 1 : -1\n\n      // if outer closing bracket, grab the match\n      if (!level && close != null) matches.push(str.slice(start, pos+close.length))\n\n    })\n\n    return matches\n  }\n\n})()\n\n// { key, i in items} -> { key, i, items }\nfunction loopKeys(expr) {\n  var b0 = brackets(0),\n      els = expr.slice(b0.length).match(/^\\s*(\\S+?)\\s*(?:,\\s*(\\S+))?\\s+in\\s+(.+)$/)\n  return els ? { key: els[1], pos: els[2], val: b0 + els[3] } : { val: expr }\n}\n\nfunction mkitem(expr, key, val) {\n  var item = {}\n  item[expr.key] = key\n  if (expr.pos) item[expr.pos] = val\n  return item\n}\n\n\n/* Beware: heavy stuff */\nfunction _each(dom, parent, expr) {\n\n  remAttr(dom, 'each')\n\n  var tagName = getTagName(dom),\n      template = dom.outerHTML,\n      hasImpl = !!tagImpl[tagName],\n      impl = tagImpl[tagName] || {\n        tmpl: template\n      },\n      root = dom.parentNode,\n      placeholder = document.createComment('riot placeholder'),\n      tags = [],\n      child = getTag(dom),\n      checksum\n\n  root.insertBefore(placeholder, dom)\n\n  expr = loopKeys(expr)\n\n  // clean template code\n  parent\n    .one('premount', function () {\n      if (root.stub) root = parent.root\n      // remove the original DOM node\n      dom.parentNode.removeChild(dom)\n    })\n    .on('update', function () {\n      var items = tmpl(expr.val, parent)\n\n      // object loop. any changes cause full redraw\n      if (!isArray(items)) {\n\n        checksum = items ? JSON.stringify(items) : ''\n\n        items = !items ? [] :\n          Object.keys(items).map(function (key) {\n            return mkitem(expr, key, items[key])\n          })\n      }\n\n      var frag = document.createDocumentFragment(),\n          i = tags.length,\n          j = items.length\n\n      // unmount leftover items\n      while (i > j) {\n        tags[--i].unmount()\n        tags.splice(i, 1)\n      }\n\n      for (i = 0; i < j; ++i) {\n        var _item = !checksum && !!expr.key ? mkitem(expr, items[i], i) : items[i]\n\n        if (!tags[i]) {\n          // mount new\n          (tags[i] = new Tag(impl, {\n              parent: parent,\n              isLoop: true,\n              hasImpl: hasImpl,\n              root: hasImpl ? dom.cloneNode() : root,\n              item: _item\n            }, dom.innerHTML)\n          ).mount()\n\n          frag.appendChild(tags[i].root)\n        } else\n          tags[i].update(_item)\n\n        tags[i]._item = _item\n\n      }\n\n      root.insertBefore(frag, placeholder)\n\n      if (child) parent.tags[tagName] = tags\n\n    }).one('updated', function() {\n      var keys = Object.keys(parent)// only set new values\n      walk(root, function(node) {\n        // only set element node and not isLoop\n        if (node.nodeType == 1 && !node.isLoop && !node._looped) {\n          node._visited = false // reset _visited for loop node\n          node._looped = true // avoid set multiple each\n          setNamed(node, parent, keys)\n        }\n      })\n    })\n\n}\n\n\nfunction parseNamedElements(root, parent, childTags) {\n\n  walk(root, function(dom) {\n    if (dom.nodeType == 1) {\n      dom.isLoop = dom.isLoop || (dom.parentNode && dom.parentNode.isLoop || dom.getAttribute('each')) ? 1 : 0\n\n      // custom child tag\n      var child = getTag(dom)\n\n      if (child && !dom.isLoop) {\n        var tag = new Tag(child, { root: dom, parent: parent }, dom.innerHTML),\n            tagName = getTagName(dom),\n            ptag = parent,\n            cachedTag\n\n        while (!getTag(ptag.root)) {\n          if (!ptag.parent) break\n          ptag = ptag.parent\n        }\n\n        // fix for the parent attribute in the looped elements\n        tag.parent = ptag\n\n        cachedTag = ptag.tags[tagName]\n\n        // if there are multiple children tags having the same name\n        if (cachedTag) {\n          // if the parent tags property is not yet an array\n          // create it adding the first cached tag\n          if (!isArray(cachedTag))\n            ptag.tags[tagName] = [cachedTag]\n          // add the new nested tag to the array\n          ptag.tags[tagName].push(tag)\n        } else {\n          ptag.tags[tagName] = tag\n        }\n\n        // empty the child node once we got its template\n        // to avoid that its children get compiled multiple times\n        dom.innerHTML = ''\n        childTags.push(tag)\n      }\n\n      if (!dom.isLoop)\n        setNamed(dom, parent, [])\n    }\n\n  })\n\n}\n\nfunction parseExpressions(root, tag, expressions) {\n\n  function addExpr(dom, val, extra) {\n    if (val.indexOf(brackets(0)) >= 0) {\n      var expr = { dom: dom, expr: val }\n      expressions.push(extend(expr, extra))\n    }\n  }\n\n  walk(root, function(dom) {\n    var type = dom.nodeType\n\n    // text node\n    if (type == 3 && dom.parentNode.tagName != 'STYLE') addExpr(dom, dom.nodeValue)\n    if (type != 1) return\n\n    /* element */\n\n    // loop\n    var attr = dom.getAttribute('each')\n\n    if (attr) { _each(dom, tag, attr); return false }\n\n    // attribute expressions\n    each(dom.attributes, function(attr) {\n      var name = attr.name,\n        bool = name.split('__')[1]\n\n      addExpr(dom, attr.value, { attr: bool || name, bool: bool })\n      if (bool) { remAttr(dom, name); return false }\n\n    })\n\n    // skip custom tags\n    if (getTag(dom)) return false\n\n  })\n\n}\nfunction Tag(impl, conf, innerHTML) {\n\n  var self = riot.observable(this),\n      opts = inherit(conf.opts) || {},\n      dom = mkdom(impl.tmpl),\n      parent = conf.parent,\n      isLoop = conf.isLoop,\n      hasImpl = conf.hasImpl,\n      item = cleanUpData(conf.item),\n      expressions = [],\n      childTags = [],\n      root = conf.root,\n      fn = impl.fn,\n      tagName = root.tagName.toLowerCase(),\n      attr = {},\n      propsInSyncWithParent = [],\n      loopDom,\n      TAG_ATTRIBUTES = /([\\w\\-]+)\\s?=\\s?['\"]([^'\"]+)[\"']/gim\n\n\n  if (fn && root._tag) {\n    root._tag.unmount(true)\n  }\n\n  // not yet mounted\n  this.isMounted = false\n  root.isLoop = isLoop\n\n  if (impl.attrs) {\n    var attrs = impl.attrs.match(TAG_ATTRIBUTES)\n\n    each(attrs, function(a) {\n      var kv = a.split(/\\s?=\\s?/)\n      root.setAttribute(kv[0], kv[1].replace(/['\"]/g, ''))\n    })\n\n  }\n\n  // keep a reference to the tag just created\n  // so we will be able to mount this tag multiple times\n  root._tag = this\n\n  // create a unique id to this tag\n  // it could be handy to use it also to improve the virtual dom rendering speed\n  this._id = fastAbs(~~(new Date().getTime() * Math.random()))\n\n  extend(this, { parent: parent, root: root, opts: opts, tags: {} }, item)\n\n  // grab attributes\n  each(root.attributes, function(el) {\n    var val = el.value\n    // remember attributes with expressions only\n    if (brackets(/\\{.*\\}/).test(val)) attr[el.name] = val\n  })\n\n  if (dom.innerHTML && !/select|select|optgroup|tbody|tr/.test(tagName))\n    // replace all the yield tags with the tag inner html\n    dom.innerHTML = replaceYield(dom.innerHTML, innerHTML)\n\n  // options\n  function updateOpts() {\n    var ctx = hasImpl && isLoop ? self : parent || self\n    // update opts from current DOM attributes\n    each(root.attributes, function(el) {\n      opts[el.name] = tmpl(el.value, ctx)\n    })\n    // recover those with expressions\n    each(Object.keys(attr), function(name) {\n      opts[name] = tmpl(attr[name], ctx)\n    })\n  }\n\n  function normalizeData(data) {\n    for (var key in item) {\n      if (typeof self[key] !== T_UNDEF)\n        self[key] = data[key]\n    }\n  }\n\n  function inheritFromParent () {\n    if (!self.parent || !isLoop) return\n    each(Object.keys(self.parent), function(k) {\n      // some properties must be always in sync with the parent tag\n      var mustSync = ~propsInSyncWithParent.indexOf(k)\n      if (typeof self[k] === T_UNDEF || mustSync) {\n        // track the property to keep in sync\n        // so we can keep it updated\n        if (!mustSync) propsInSyncWithParent.push(k)\n        self[k] = self.parent[k]\n      }\n    })\n  }\n\n  this.update = function(data) {\n    // make sure the data passed will not override\n    // the component core methods\n    data = cleanUpData(data)\n    // inherit properties from the parent\n    inheritFromParent()\n    // normalize the tag properties in case an item object was initially passed\n    if (typeof item === T_OBJECT || isArray(item)) {\n      normalizeData(data)\n      item = data\n    }\n    extend(self, data)\n    updateOpts()\n    self.trigger('update', data)\n    update(expressions, self)\n    self.trigger('updated')\n  }\n\n  this.mixin = function() {\n    each(arguments, function(mix) {\n      mix = typeof mix === T_STRING ? riot.mixin(mix) : mix\n      each(Object.keys(mix), function(key) {\n        // bind methods to self\n        if (key != 'init')\n          self[key] = isFunction(mix[key]) ? mix[key].bind(self) : mix[key]\n      })\n      // init method will be called automatically\n      if (mix.init) mix.init.bind(self)()\n    })\n  }\n\n  this.mount = function() {\n\n    updateOpts()\n\n    // initialiation\n    fn && fn.call(self, opts)\n\n    toggle(true)\n\n\n    // parse layout after init. fn may calculate args for nested custom tags\n    parseExpressions(dom, self, expressions)\n    if (!self.parent || hasImpl) parseExpressions(self.root, self, expressions) // top level before update, empty root\n\n    if (!self.parent || isLoop) self.update(item)\n\n    // internal use only, fixes #403\n    self.trigger('premount')\n\n    if (isLoop && !hasImpl) {\n      // update the root attribute for the looped elements\n      self.root = root = loopDom = dom.firstChild\n\n    } else {\n      while (dom.firstChild) root.appendChild(dom.firstChild)\n      if (root.stub) self.root = root = parent.root\n    }\n    // if it's not a child tag we can trigger its mount event\n    if (!self.parent || self.parent.isMounted) {\n      self.isMounted = true\n      self.trigger('mount')\n    }\n    // otherwise we need to wait that the parent event gets triggered\n    else self.parent.one('mount', function() {\n      // avoid to trigger the `mount` event for the tags\n      // not visible included in an if statement\n      if (!isInStub(self.root)) {\n        self.parent.isMounted = self.isMounted = true\n        self.trigger('mount')\n      }\n    })\n  }\n\n\n  this.unmount = function(keepRootTag) {\n    var el = loopDom || root,\n        p = el.parentNode\n\n    if (p) {\n\n      if (parent)\n        // remove this tag from the parent tags object\n        // if there are multiple nested tags with same name..\n        // remove this element form the array\n        if (isArray(parent.tags[tagName]))\n          each(parent.tags[tagName], function(tag, i) {\n            if (tag._id == self._id)\n              parent.tags[tagName].splice(i, 1)\n          })\n        else\n          // otherwise just delete the tag instance\n          parent.tags[tagName] = undefined\n      else\n        while (el.firstChild) el.removeChild(el.firstChild)\n\n      if (!keepRootTag)\n        p.removeChild(el)\n\n    }\n\n\n    self.trigger('unmount')\n    toggle()\n    self.off('*')\n    // somehow ie8 does not like `delete root._tag`\n    root._tag = null\n\n  }\n\n  function toggle(isMount) {\n\n    // mount/unmount children\n    each(childTags, function(child) { child[isMount ? 'mount' : 'unmount']() })\n\n    // listen/unlisten parent (events flow one way from parent to children)\n    if (parent) {\n      var evt = isMount ? 'on' : 'off'\n\n      // the loop tags will be always in sync with the parent automatically\n      if (isLoop)\n        parent[evt]('unmount', self.unmount)\n      else\n        parent[evt]('update', self.update)[evt]('unmount', self.unmount)\n    }\n  }\n\n  // named elements available for fn\n  parseNamedElements(dom, this, childTags)\n\n\n}\n\nfunction setEventHandler(name, handler, dom, tag) {\n\n  dom[name] = function(e) {\n\n    var item = tag._item,\n        ptag = tag.parent\n\n    if (!item)\n      while (ptag) {\n        item = ptag._item\n        ptag = item ? false : ptag.parent\n      }\n\n    // cross browser event fix\n    e = e || window.event\n\n    // ignore error on some browsers\n    try {\n      e.currentTarget = dom\n      if (!e.target) e.target = e.srcElement\n      if (!e.which) e.which = e.charCode || e.keyCode\n    } catch (ignored) { '' }\n\n    e.item = item\n\n    // prevent default behaviour (by default)\n    if (handler.call(tag, e) !== true && !/radio|check/.test(dom.type)) {\n      e.preventDefault && e.preventDefault()\n      e.returnValue = false\n    }\n\n    if (!e.preventUpdate) {\n      var el = item ? tag.parent : tag\n      el.update()\n    }\n\n  }\n\n}\n\n// used by if- attribute\nfunction insertTo(root, node, before) {\n  if (root) {\n    root.insertBefore(before, node)\n    root.removeChild(node)\n  }\n}\n\nfunction update(expressions, tag) {\n\n  each(expressions, function(expr, i) {\n\n    var dom = expr.dom,\n        attrName = expr.attr,\n        value = tmpl(expr.expr, tag),\n        parent = expr.dom.parentNode\n\n    if (value == null) value = ''\n\n    // leave out riot- prefixes from strings inside textarea\n    if (parent && parent.tagName == 'TEXTAREA') value = value.replace(/riot-/g, '')\n\n    // no change\n    if (expr.value === value) return\n    expr.value = value\n\n    // text node\n    if (!attrName) return dom.nodeValue = value.toString()\n\n    // remove original attribute\n    remAttr(dom, attrName)\n\n    // event handler\n    if (isFunction(value)) {\n      setEventHandler(attrName, value, dom, tag)\n\n    // if- conditional\n    } else if (attrName == 'if') {\n      var stub = expr.stub\n\n      // add to DOM\n      if (value) {\n        if (stub) {\n          insertTo(stub.parentNode, stub, dom)\n          dom.inStub = false\n          // avoid to trigger the mount event if the tags is not visible yet\n          // maybe we can optimize this avoiding to mount the tag at all\n          if (!isInStub(dom)) {\n            walk(dom, function(el) {\n              if (el._tag && !el._tag.isMounted) el._tag.isMounted = !!el._tag.trigger('mount')\n            })\n          }\n        }\n      // remove from DOM\n      } else {\n        stub = expr.stub = stub || document.createTextNode('')\n        insertTo(dom.parentNode, dom, stub)\n        dom.inStub = true\n      }\n    // show / hide\n    } else if (/^(show|hide)$/.test(attrName)) {\n      if (attrName == 'hide') value = !value\n      dom.style.display = value ? '' : 'none'\n\n    // field value\n    } else if (attrName == 'value') {\n      dom.value = value\n\n    // <img src=\"{ expr }\">\n    } else if (attrName.slice(0, 5) == 'riot-' && attrName != 'riot-tag') {\n      attrName = attrName.slice(5)\n      value ? dom.setAttribute(attrName, value) : remAttr(dom, attrName)\n\n    } else {\n      if (expr.bool) {\n        dom[attrName] = value\n        if (!value) return\n        value = attrName\n      }\n\n      if (typeof value !== T_OBJECT) dom.setAttribute(attrName, value)\n\n    }\n\n  })\n\n}\n\nfunction each(els, fn) {\n  for (var i = 0, len = (els || []).length, el; i < len; i++) {\n    el = els[i]\n    // return false -> remove current item during loop\n    if (el != null && fn(el, i) === false) i--\n  }\n  return els\n}\n\nfunction isFunction(v) {\n  return typeof v === 'function' || false   // avoid IE problems\n}\n\nfunction remAttr(dom, name) {\n  dom.removeAttribute(name)\n}\n\nfunction fastAbs(nr) {\n  return (nr ^ (nr >> 31)) - (nr >> 31)\n}\n\nfunction getTag(dom) {\n  var tagName = dom.tagName.toLowerCase()\n  return tagImpl[dom.getAttribute(RIOT_TAG) || tagName]\n}\n\nfunction getTagName(dom) {\n  var child = getTag(dom),\n    namedTag = dom.getAttribute('name'),\n    tagName = namedTag && namedTag.indexOf(brackets(0)) < 0 ? namedTag : child ? child.name : dom.tagName.toLowerCase()\n\n  return tagName\n}\n\nfunction extend(src) {\n  var obj, args = arguments\n  for (var i = 1; i < args.length; ++i) {\n    if ((obj = args[i])) {\n      for (var key in obj) {      // eslint-disable-line guard-for-in\n        src[key] = obj[key]\n      }\n    }\n  }\n  return src\n}\n\n// with this function we avoid that the current Tag methods get overridden\nfunction cleanUpData(data) {\n  if (!(data instanceof Tag)) return data\n\n  var o = {},\n      blackList = ['update', 'root', 'mount', 'unmount', 'mixin', 'isMounted', 'isloop', 'tags', 'parent', 'opts']\n  for (var key in data) {\n    if (!~blackList.indexOf(key))\n      o[key] = data[key]\n  }\n  return o\n}\n\nfunction mkdom(template) {\n  var checkie = ieVersion && ieVersion < 10,\n      matches = /^\\s*<([\\w-]+)/.exec(template),\n      tagName = matches ? matches[1].toLowerCase() : '',\n      rootTag = (tagName === 'th' || tagName === 'td') ? 'tr' :\n                (tagName === 'tr' ? 'tbody' : 'div'),\n      el = mkEl(rootTag)\n\n  el.stub = true\n\n  if (checkie) {\n    if (tagName === 'optgroup')\n      optgroupInnerHTML(el, template)\n    else if (tagName === 'option')\n      optionInnerHTML(el, template)\n    else if (rootTag !== 'div')\n      tbodyInnerHTML(el, template, tagName)\n    else\n      checkie = 0\n  }\n  if (!checkie) el.innerHTML = template\n\n  return el\n}\n\nfunction walk(dom, fn) {\n  if (dom) {\n    if (fn(dom) === false) walk(dom.nextSibling, fn)\n    else {\n      dom = dom.firstChild\n\n      while (dom) {\n        walk(dom, fn)\n        dom = dom.nextSibling\n      }\n    }\n  }\n}\n\nfunction isInStub(dom) {\n  while (dom) {\n    if (dom.inStub) return true\n    dom = dom.parentNode\n  }\n  return false\n}\n\nfunction mkEl(name) {\n  return document.createElement(name)\n}\n\nfunction replaceYield (tmpl, innerHTML) {\n  return tmpl.replace(/<(yield)\\/?>(<\\/\\1>)?/gim, innerHTML || '')\n}\n\nfunction $$(selector, ctx) {\n  return (ctx || document).querySelectorAll(selector)\n}\n\nfunction $(selector, ctx) {\n  return (ctx || document).querySelector(selector)\n}\n\nfunction inherit(parent) {\n  function Child() {}\n  Child.prototype = parent\n  return new Child()\n}\n\nfunction setNamed(dom, parent, keys) {\n  each(dom.attributes, function(attr) {\n    if (dom._visited) return\n    if (attr.name === 'id' || attr.name === 'name') {\n      dom._visited = true\n      var p, v = attr.value\n      if (~keys.indexOf(v)) return\n\n      p = parent[v]\n      if (!p)\n        parent[v] = dom\n      else\n        isArray(p) ? p.push(dom) : (parent[v] = [p, dom])\n    }\n  })\n}\n/**\n *\n * Hacks needed for the old internet explorer versions [lower than IE10]\n *\n */\n/* istanbul ignore next */\nfunction tbodyInnerHTML(el, html, tagName) {\n  var div = mkEl('div'),\n      loops = /td|th/.test(tagName) ? 3 : 2,\n      child\n\n  div.innerHTML = '<table>' + html + '</table>'\n  child = div.firstChild\n\n  while (loops--) child = child.firstChild\n\n  el.appendChild(child)\n\n}\n/* istanbul ignore next */\nfunction optionInnerHTML(el, html) {\n  var opt = mkEl('option'),\n      valRegx = /value=[\\\"'](.+?)[\\\"']/,\n      selRegx = /selected=[\\\"'](.+?)[\\\"']/,\n      eachRegx = /each=[\\\"'](.+?)[\\\"']/,\n      ifRegx = /if=[\\\"'](.+?)[\\\"']/,\n      innerRegx = />([^<]*)</,\n      valuesMatch = html.match(valRegx),\n      selectedMatch = html.match(selRegx),\n      innerValue = html.match(innerRegx),\n      eachMatch = html.match(eachRegx),\n      ifMatch = html.match(ifRegx)\n\n  if (innerValue) opt.innerHTML = innerValue[1]\n  else opt.innerHTML = html\n\n  if (valuesMatch) opt.value = valuesMatch[1]\n  if (selectedMatch) opt.setAttribute('riot-selected', selectedMatch[1])\n  if (eachMatch) opt.setAttribute('each', eachMatch[1])\n  if (ifMatch) opt.setAttribute('if', ifMatch[1])\n\n  el.appendChild(opt)\n}\n/* istanbul ignore next */\nfunction optgroupInnerHTML(el, html) {\n  var opt = mkEl('optgroup'),\n      labelRegx = /label=[\\\"'](.+?)[\\\"']/,\n      elementRegx = /^<([^>]*)>/,\n      tagRegx = /^<([^ \\>]*)/,\n      labelMatch = html.match(labelRegx),\n      elementMatch = html.match(elementRegx),\n      tagMatch = html.match(tagRegx),\n      innerContent = html\n\n  if (elementMatch) {\n    var options = html.slice(elementMatch[1].length+2, -tagMatch[1].length-3).trim()\n    innerContent = options\n  }\n\n  if (labelMatch) opt.setAttribute('riot-label', labelMatch[1])\n\n  if (innerContent) {\n    var innerOpt = mkEl('div')\n\n    optionInnerHTML(innerOpt, innerContent)\n\n    opt.appendChild(innerOpt.firstChild)\n  }\n\n  el.appendChild(opt)\n}\n\n/*\n Virtual dom is an array of custom tags on the document.\n Updates and unmounts propagate downwards from parent to children.\n*/\n\nvar virtualDom = [],\n    tagImpl = {},\n    styleNode\n\nvar RIOT_TAG = 'riot-tag'\n\nfunction injectStyle(css) {\n\n  styleNode = styleNode || mkEl('style')\n\n  if (!document.head) return\n\n  if (styleNode.styleSheet)\n    styleNode.styleSheet.cssText += css\n  else\n    styleNode.innerHTML += css\n\n  if (!styleNode._rendered)\n    if (styleNode.styleSheet) {\n      document.body.appendChild(styleNode)\n    } else {\n      var rs = $('style[type=riot]')\n      if (rs) {\n        rs.parentNode.insertBefore(styleNode, rs)\n        rs.parentNode.removeChild(rs)\n      } else document.head.appendChild(styleNode)\n\n    }\n\n  styleNode._rendered = true\n\n}\n\nfunction mountTo(root, tagName, opts) {\n  var tag = tagImpl[tagName],\n      // cache the inner HTML to fix #855\n      innerHTML = root._innerHTML = root._innerHTML || root.innerHTML\n\n  // clear the inner html\n  root.innerHTML = ''\n\n  if (tag && root) tag = new Tag(tag, { root: root, opts: opts }, innerHTML)\n\n  if (tag && tag.mount) {\n    tag.mount()\n    virtualDom.push(tag)\n    return tag.on('unmount', function() {\n      virtualDom.splice(virtualDom.indexOf(tag), 1)\n    })\n  }\n\n}\n\nriot.tag = function(name, html, css, attrs, fn) {\n  if (isFunction(attrs)) {\n    fn = attrs\n    if (/^[\\w\\-]+\\s?=/.test(css)) {\n      attrs = css\n      css = ''\n    } else attrs = ''\n  }\n  if (css) {\n    if (isFunction(css)) fn = css\n    else injectStyle(css)\n  }\n  tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\nriot.mount = function(selector, tagName, opts) {\n\n  var els,\n      allTags,\n      tags = []\n\n  // helper functions\n\n  function addRiotTags(arr) {\n    var list = ''\n    each(arr, function (e) {\n      list += ', *[riot-tag=\"'+ e.trim() + '\"]'\n    })\n    return list\n  }\n\n  function selectAllTags() {\n    var keys = Object.keys(tagImpl)\n    return keys + addRiotTags(keys)\n  }\n\n  function pushTags(root) {\n    if (root.tagName) {\n      if (tagName && !root.getAttribute(RIOT_TAG))\n        root.setAttribute(RIOT_TAG, tagName)\n\n      var tag = mountTo(root,\n        tagName || root.getAttribute(RIOT_TAG) || root.tagName.toLowerCase(), opts)\n\n      if (tag) tags.push(tag)\n    }\n    else if (root.length) {\n      each(root, pushTags)   // assume nodeList\n    }\n  }\n\n  // ----- mount code -----\n\n  if (typeof tagName === T_OBJECT) {\n    opts = tagName\n    tagName = 0\n  }\n\n  // crawl the DOM to find the tag\n  if (typeof selector === T_STRING) {\n    if (selector === '*')\n      // select all the tags registered\n      // and also the tags found with the riot-tag attribute set\n      selector = allTags = selectAllTags()\n    else\n      // or just the ones named like the selector\n      selector += addRiotTags(selector.split(','))\n\n    els = $$(selector)\n  }\n  else\n    // probably you have passed already a tag or a NodeList\n    els = selector\n\n  // select all the registered and mount them inside their root elements\n  if (tagName === '*') {\n    // get all custom tags\n    tagName = allTags || selectAllTags()\n    // if the root els it's just a single tag\n    if (els.tagName)\n      els = $$(tagName, els)\n    else {\n      // select all the children for all the different root elements\n      var nodeList = []\n      each(els, function (_el) {\n        nodeList.push($$(tagName, _el))\n      })\n      els = nodeList\n    }\n    // get rid of the tagName\n    tagName = 0\n  }\n\n  if (els.tagName)\n    pushTags(els)\n  else\n    each(els, pushTags)\n\n  return tags\n}\n\n// update everything\nriot.update = function() {\n  return each(virtualDom, function(tag) {\n    tag.update()\n  })\n}\n\n// @deprecated\nriot.mountTo = riot.mount\n\n\n  // share methods for other riot parts, e.g. compiler\n  riot.util = { brackets: brackets, tmpl: tmpl }\n\n  // support CommonJS, AMD & browser\n  /* istanbul ignore next */\n  if (typeof exports === T_OBJECT)\n    module.exports = riot\n  else if (typeof define === 'function' && define.amd)\n    define(function() { return window.riot = riot })\n  else\n    window.riot = riot\n\n})(typeof window != 'undefined' ? window : undefined);\n","var riot = require('riot');\nriot.tag('user-view', '<div class=\"view user-view\" show=\"{ user }\"> <ul> <li><span class=\"label\">user:</span> { user.id }</li> <li><span class=\"label\">created:</span> { filters.fromNow(user.created) } ago</li> <li><span class=\"label\">karma:</span> { user.karma }</li> <li> <span class=\"label\">about:</span> <div class=\"about\" name=\"about\"></div> </li> </ul> <p class=\"links\"> <a href=\"https://news.ycombinator.com/submitted?id={ user.id }\">submissions</a><br> <a href=\"https://news.ycombinator.com/threads?id={ user.id }\">comments</a> </p> </div>', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.on('mount', function() {\n    store.fetchUser(opts.data, function (user) {\n      self.user = user\n      self.about.innerHTML = self.user.about\n      self.update()\n    })\n  })\n  \n});\n","var riot = require('riot');\nriot.tag('item-view', '<div class=\"view item-view\" show=\"{ items.length }\"> <item class=\"item\" each=\"{ items }\" data=\"{ this }\"></item> <ul class=\"poll-options\" if=\"{ pollOptions }\"> <li each=\"{ pollOptions }\"> <p>{ text }</p> <p class=\"subtext\">{ score } points</p> </li> </ul> <ul class=\"comments\"> <div each=\"{ c, i in comments }\"> <comment data=\"{ c }\"></comment> </div> </ul> <p show=\"{ !comments.length }\">No comments yet.</p> </div>', function(opts) {\n  require('../components/item.html')\n  require('../components/comment.html')\n  var store = require('../store')\n  var self = this\n  self.items = []\n\n  this.fetchComments = function() {\n    store.fetchItems(self.items[0].kids, function (comments) {\n      self.comments = comments\n      self.update()\n    })\n  }.bind(this);\n\n  this.fetchPollOptions = function() {\n    store.fetchItems(self.items[0].parts, function (options) {\n      self.pollOptions = options\n      self.update()\n    })\n  }.bind(this);\n\n  store.fetchItem(opts.data, function (item) {\n    self.items = [ item ]\n    self.fetchComments()\n    if (item.type === 'poll') {\n      self.fetchPollOptions()\n    }\n    self.update()\n  })\n  \n});\n","var riot = require('riot');\nriot.tag('news-view', '<div class=\"view news-view\" class=\"{loading: !items.length}\"> <ul> <li class=\"item\" each=\"{ item, i in items }\" track-by=\"id\"> <item data=\"{ item }\" index=\"{ (parent.page - 1) * 30 + i + 1}\" ></item> </li> </ul> <div class=\"nav\" show=\"{ items.length }\"> <a if=\"{ page > 1 }\" href=\"#news/{ page - 1 }\">&lt; prev</a> <a if=\"{ page < 4 }\" href=\"#news/{ page - -1 }\">more...</a> </div> </div>', function(opts) {\n  require('../components/item.html')\n  var store = require('../store')\n  var self = this\n  self.page = opts.data\n  self.items = []\n\n  this.fetchNews = function() {\n    store.fetchItemsByPage(self.page, function (items) {\n      self.items = items\n      self.displayPage = self.page\n      self.update()\n    })\n  }.bind(this);\n\n  self.on('mount', function() {\n    self.fetchNews()\n    store.on('update', self.fetchNews)\n  })\n\n  self.on('unmount', function() {\n    store.removeListener('update', self.fetchNews)\n  })\n  \n});\n","//var Firebase = require('firebase')\nvar api = new Firebase('https://hacker-news.firebaseio.com/v0')\nvar storiesPerPage = 30\nvar cachedStoryIds = []\nvar Emitter = require('events').EventEmitter\nvar store = module.exports = new Emitter()\n\n/**\n * Subscribe to real time updates of the top 100 stories,\n * and cache the IDs locally.\n */\n\napi.child('topstories').on('value', function (snapshot) {\n  cachedStoryIds = snapshot.val()\n  store.emit('update')\n})\n\n/**\n * Fetch an item data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(item)\n */\n\nstore.fetchItem = function (id, cb) {\n  api.child('item/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch a user data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(user)\n */\n\nstore.fetchUser = function (id, cb) {\n  api.child('user/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch the given list of items.\n *\n * @param {Array<Number>} ids\n * @param {Function} cb(items)\n */\n\nstore.fetchItems = function (ids, cb) {\n  if (!ids || !ids.length) return cb([])\n  var items = []\n  ids.forEach(function (id) {\n    store.fetchItem(id, addItem)\n  })\n  function addItem (item) {\n    items.push(item)\n    if (items.length >= ids.length) {\n      cb(items)\n    }\n  }\n}\n\n/**\n * Fetch items for the given page.\n *\n * @param {Number} page\n * @param {Function} cb(stories)\n */\n\nstore.fetchItemsByPage = function (page, cb) {\n  var start = (page - 1) * storiesPerPage\n  var end = page * storiesPerPage\n  var ids = cachedStoryIds.slice(start, end)\n  store.fetchItems(ids, cb)\n}\n","var riot = require('riot');\nriot.tag('item', '<span class=\"index\">{ opts.index }.</span> <p> <a class=\"title\" href=\"{ href() }\" target=\"_blank\">{ itemdata.title }</a> <span class=\"domain\" show=\"{ showDomain() }\"> ({ filters.domain(itemdata.url) }) </span> </p> <p class=\"subtext\"> <span show=\"{ showInfo() }\"> { itemdata.score } points by <a href=\"#user/{ itemdata.by }\">{ itemdata.by }</a> </span> { filters.fromNow(itemdata.time) } ago <span class=\"comments-link\" show=\"{ showInfo() }\"> | <a href=\"#item/{ itemdata.id }\">comments</a> </span> </p>', function(opts) {\n  var self = this\n  self.itemdata = opts.data\n\n  this.href = function() {\n    return self.itemdata.url || ('#/item/' + self.itemdata.id)\n  }.bind(this);\n\n  this.showInfo = function() {\n    return self.itemdata.type === 'story' || self.itemdata.type === 'poll'\n  }.bind(this);\n\n  this.showDomain = function() {\n    return self.itemdata.type === 'story'\n  }.bind(this);\n  \n});\n","var riot = require('riot');\nriot.tag('comment', '<li show=\"{ data.text }\"> <div class=\"comhead\"> <a class=\"toggle\" onclick=\"{ toggle }\">{ open ? \\'[-]\\' : \\'[+]\\' }</a> <a href=\"#user/{ data.by }\">{ data.by }</a> { filters.fromNow(data.time) } ago </div> <div class=\"comment-content\" name=\"commentcontent\" show=\"{ open }\"></div> <ul class=\"child-comments\" if=\"{ data.kids }\" show=\"{ open }\"> <div each=\"{ c, i in comments }\"> <comment data=\"{ c }\"></comment> <div> </ul> </li>', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.data = opts.data\n  self.open = true\n  self.commentcontent.innerHTML = self.data.text\n\n  store.fetchItems(self.data.kids, function(result) {\n    self.comments = result\n    self.update()\n  })\n\n  this.toggle = function(e) {\n    this.open = !this.open\n  }.bind(this);\n  \n});\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n"]}