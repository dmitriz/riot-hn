{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/index.js","src/filters.js","src/app.html","src/views/user-view.html","src/views/item-view.html","src/views/news-view.html","node_modules/riot/riot.js","src/components/item.html","src/components/comment.html","src/store.js","node_modules/browserify/node_modules/events/events.js"],"names":["require","mount","parser","document","createElement","filters","fromNow","time","between","Date","now","Number","domain","url","href","hostname","riot","tag","opts","self","this","currentView","loadView","viewName","id","unmount","data","bind","studyRoute","view","route","on","exec","store","fetchUser","user","about","innerHTML","update","items","fetchComments","fetchItems","kids","comments","fetchPollOptions","parts","options","pollOptions","fetchItem","item","type","page","fetchNews","fetchItemsByPage","displayPage","removeListener","window","loopKeys","expr","ret","val","els","split","brackets","slice","length","trim","key","pos","mkitem","_each","dom","parent","add","rendered","splice","tags","remAttr","checksum","template","outerHTML","prev","previousSibling","root","parentNode","one","removeChild","stub","tmpl","Array","isArray","testsum","JSON","stringify","each","Object","keys","map","indexOf","newItems","arrFindEquals","oldItems","prevBase","call","childNodes","i","oldPos","lastIndexOf","nodes","_item","Tag","before","insertBefore","walk","attributes","attr","test","name","value","parseNamedElements","childTags","nodeType","isLoop","getAttribute","child","getTag","cachedTag","namedTag","tagName","ptag","push","parseExpressions","expressions","addExpr","extra","extend","nodeValue","bool","impl","conf","updateOpts","toggle","isMount","evt","loopDom","observable","inherit","mkdom","fn","toLowerCase","TAG_ATTRIBUTES","_tag","attrs","match","a","kv","setAttribute","replace","_id","fastAbs","getTime","Math","random","el","replaceYield","init","trigger","mixin","arguments","mix","firstChild","appendChild","keepRootTag","p","undefined","off","setEventHandler","handler","e","event","which","charCode","keyCode","target","srcElement","currentTarget","preventDefault","returnValue","preventUpdate","insertTo","node","attrName","toString","createTextNode","style","display","len","removeAttribute","nr","obj","from","from2","checkIE","ua","navigator","userAgent","msie","parseInt","substring","optionInnerHTML","html","opt","valRegx","selRegx","valuesMatch","selectedMatch","tbodyInnerHTML","div","rootTag","mkEl","ieVersion","nextSibling","$$","selector","ctx","querySelectorAll","arr","filter","_el","Child","prototype","loops","tagImpl","injectStyle","css","styleNode","head","styleSheet","cssText","_rendered","body","mountTo","virtualDom","version","settings","callbacks","events","typed","cb","apply","args","fns","busy","concat","all","registeredMixins","hash","loc","path","emit","current","location","win","started","r","arg","stop","removeEventListener","detachEvent","start","addEventListener","attachEvent","orig","s","b","x","RegExp","source","global","extract","Function","join","n","pair","_","k","v","wrap","nonull","reVars","str","substrings","sub","open","close","level","matches","re","cache","allTags","selctAllTags","list","t","nodeList","util","exports","module","define","amd","itemdata","showInfo","showDomain","commentcontent","text","result","api","Firebase","storiesPerPage","cachedStoryIds","Emitter","EventEmitter","snapshot","once","ids","addItem","forEach","end","_events","_maxListeners","isFunction","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","isNaN","TypeError","er","listeners","error","Error","addListener","listener","m","newListener","warned","console","trace","g","fired","position","removeAllListeners","listenerCount","emitter"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","require('./filters.js')\nrequire('./app.html')\nrequire('riot').mount('app')\n","var parser = document.createElement('a')\n\nfilters = {\n  fromNow: function(time) {\n    var between = Date.now() / 1000 - Number(time)\n    if (between < 3600) {\n      return ~~(between / 60) + ' minutes'\n    } else if (between < 86400) {\n      return ~~(between / 3600) + ' hours'\n    } else {\n      return ~~(between / 86400) + ' days'\n    }\n  },\n  domain: function(url) {\n    parser.href = url\n    return parser.hostname\n  }\n}\n","var riot = require('riot');\nriot.tag('app', '<div id=\"header\"> <a id=\"yc\" href=\"http://www.ycombinator.com\"> <img src=\"https://news.ycombinator.com/y18.gif\"> </a> <h1><a href=\"#\">Hacker News</a></h1> <span class=\"source\"> Built with <a href=\"https://muut.com/riotjs/\" target=\"_blank\">Riot.js</a> | <a href=\"https://github.com/txchen/riot-hn\" target=\"_blank\">Source</a> </span> </div> <div id=\"hnview\"></div>', function(opts) {\n  var self = this\n  self.currentView = null\n\n  this.loadView = function(viewName, id) {\n    if (self.currentView) {\n      self.currentView.unmount(true)\n    }\n    self.currentView = riot.mount('div#hnview', viewName, {data: id})[0]\n  }.bind(this);\n\n  this.studyRoute = function(view, id) {\n    switch(view) {\n    case 'user':\n      require('./views/user-view.html')\n      self.loadView('user-view', id)\n      break\n    case 'item':\n      require('./views/item-view.html')\n      self.loadView('item-view', id)\n      break\n    case 'news':\n      require('./views/news-view.html')\n      self.loadView('news-view', id)\n      break\n    default:\n      riot.route('news/1')\n    }\n  }.bind(this);\n  riot.route(self.studyRoute)\n  this.on('mount', function() {\n    riot.route.exec(self.studyRoute)\n  })\n  \n});\n","var riot = require('riot');\nriot.tag('user-view', '<div class=\"view user-view\" show=\"{ user }\"> <ul> <li><span class=\"label\">user:</span> { user.id }</li> <li><span class=\"label\">created:</span> { filters.fromNow(user.created) } ago</li> <li><span class=\"label\">karma:</span> { user.karma }</li> <li> <span class=\"label\">about:</span> <div class=\"about\" name=\"about\"></div> </li> </ul> <p class=\"links\"> <a href=\"https://news.ycombinator.com/submitted?id={ user.id }\">submissions</a><br> <a href=\"https://news.ycombinator.com/threads?id={ user.id }\">comments</a> </p> </div>', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.on('mount', function() {\n    store.fetchUser(opts.data, function (user) {\n      self.user = user\n      self.about.innerHTML = self.user.about\n      self.update()\n    })\n  })\n  \n});\n","var riot = require('riot');\nriot.tag('item-view', '<div class=\"view item-view\" show=\"{ items.length }\"> <item class=\"item\" each=\"{ items }\" data=\"{ this }\"></item> <ul class=\"poll-options\" if=\"{ pollOptions }\"> <li each=\"{ pollOptions }\"> <p>{ text }</p> <p class=\"subtext\">{ score } points</p> </li> </ul> <ul class=\"comments\"> <div each=\"{ c, i in comments }\"> <comment data=\"{ c }\"></comment> </div> </ul> <p show=\"{ !comments.length }\">No comments yet.</p> </div>', function(opts) {\n  require('../components/item.html')\n  require('../components/comment.html')\n  var store = require('../store')\n  var self = this\n  self.items = []\n\n  this.fetchComments = function() {\n    store.fetchItems(self.items[0].kids, function (comments) {\n      self.comments = comments\n      self.update()\n    })\n  }.bind(this);\n\n  this.fetchPollOptions = function() {\n    store.fetchItems(self.items[0].parts, function (options) {\n      self.pollOptions = options\n      self.update()\n    })\n  }.bind(this);\n\n  store.fetchItem(opts.data, function (item) {\n    self.items = [ item ]\n    self.fetchComments()\n    if (item.type === 'poll') {\n      self.fetchPollOptions()\n    }\n    self.update()\n  })\n  \n});\n","var riot = require('riot');\nriot.tag('news-view', '<div class=\"view news-view\" class=\"{loading: !items.length}\"> <ul> <li class=\"item\" each=\"{ item, i in items }\" track-by=\"id\"> <item data=\"{ item }\" index=\"{ (parent.page - 1) * 30 + i + 1}\" ></item> </li> </ul> <div class=\"nav\" show=\"{ items.length }\"> <a if=\"{ page > 1 }\" href=\"#news/{ page - 1 }\">&lt; prev</a> <a if=\"{ page < 4 }\" href=\"#news/{ page - -1 }\">more...</a> </div> </div>', function(opts) {\n  require('../components/item.html')\n  var store = require('../store')\n  var self = this\n  self.page = opts.data\n  self.items = []\n\n  this.fetchNews = function() {\n    store.fetchItemsByPage(self.page, function (items) {\n      self.items = items\n      self.displayPage = self.page\n      self.update()\n    })\n  }.bind(this);\n\n  self.on('mount', function() {\n    self.fetchNews()\n    store.on('update', self.fetchNews)\n  })\n\n  self.on('unmount', function() {\n    store.removeListener('update', self.fetchNews)\n  })\n  \n});\n","/* Riot v2.1.0, @license MIT, (c) 2015 Muut Inc. + contributors */\n\n;(function(window) {\n  // 'use strict' does not allow us to override the events properties https://github.com/muut/riotjs/blob/dev/lib/tag/update.js#L7-L10\n  // it leads to the following error on firefox \"setting a property that has only a getter\"\n  //'use strict'\n\n\n  var riot = { version: 'v2.1.0', settings: {} }\n\n\nriot.observable = function(el) {\n\n  el = el || {}\n\n  var callbacks = {},\n      _id = 0\n\n  el.on = function(events, fn) {\n    if (typeof fn == 'function') {\n      fn._id = typeof fn._id == 'undefined' ? _id++ : fn._id\n\n      events.replace(/\\S+/g, function(name, pos) {\n        (callbacks[name] = callbacks[name] || []).push(fn)\n        fn.typed = pos > 0\n      })\n    }\n    return el\n  }\n\n  el.off = function(events, fn) {\n    if (events == '*') callbacks = {}\n    else {\n      events.replace(/\\S+/g, function(name) {\n        if (fn) {\n          var arr = callbacks[name]\n          for (var i = 0, cb; (cb = arr && arr[i]); ++i) {\n            if (cb._id == fn._id) { arr.splice(i, 1); i-- }\n          }\n        } else {\n          callbacks[name] = []\n        }\n      })\n    }\n    return el\n  }\n\n  // only single event supported\n  el.one = function(name, fn) {\n    function on() {\n      el.off(name, on)\n      fn.apply(el, arguments)\n    }\n    return el.on(name, on)\n  }\n\n  el.trigger = function(name) {\n    var args = [].slice.call(arguments, 1),\n        fns = callbacks[name] || []\n\n    for (var i = 0, fn; (fn = fns[i]); ++i) {\n      if (!fn.busy) {\n        fn.busy = 1\n        fn.apply(el, fn.typed ? [name].concat(args) : args)\n        if (fns[i] !== fn) { i-- }\n        fn.busy = 0\n      }\n    }\n\n    if (callbacks.all && name != 'all') {\n      el.trigger.apply(el, ['all', name].concat(args))\n    }\n\n    return el\n  }\n\n  return el\n\n}\nriot.mixin = (function() {\n  var registeredMixins = {}\n  return function(name, mixin) {\n    if (!mixin) return registeredMixins[name]\n      else registeredMixins[name] = mixin\n  }\n})()\n\n;(function(riot, evt, window) {\n\n  // browsers only\n  if (!window) return\n\n  var loc = window.location,\n      fns = riot.observable(),\n      win = window,\n      started = false,\n      current\n\n  function hash() {\n    return loc.href.split('#')[1] || ''\n  }\n\n  function parser(path) {\n    return path.split('/')\n  }\n\n  function emit(path) {\n    if (path.type) path = hash()\n\n    if (path != current) {\n      fns.trigger.apply(null, ['H'].concat(parser(path)))\n      current = path\n    }\n  }\n\n  var r = riot.route = function(arg) {\n    // string\n    if (arg[0]) {\n      loc.hash = arg\n      emit(arg)\n\n    // function\n    } else {\n      fns.on('H', arg)\n    }\n  }\n\n  r.exec = function(fn) {\n    fn.apply(null, parser(hash()))\n  }\n\n  r.parser = function(fn) {\n    parser = fn\n  }\n\n  r.stop = function () {\n    if (!started) return\n    win.removeEventListener ? win.removeEventListener(evt, emit, false) : win.detachEvent('on' + evt, emit)\n    fns.off('*')\n    started = false\n  }\n\n  r.start = function () {\n    if (started) return\n    win.addEventListener ? win.addEventListener(evt, emit, false) : win.attachEvent('on' + evt, emit)\n    started = true\n  }\n\n  // autostart the router\n  r.start()\n\n})(riot, 'hashchange', window)\n/*\n\n//// How it works?\n\n\nThree ways:\n\n1. Expressions: tmpl('{ value }', data).\n   Returns the result of evaluated expression as a raw object.\n\n2. Templates: tmpl('Hi { name } { surname }', data).\n   Returns a string with evaluated expressions.\n\n3. Filters: tmpl('{ show: !done, highlight: active }', data).\n   Returns a space separated list of trueish keys (mainly\n   used for setting html classes), e.g. \"show highlight\".\n\n\n// Template examples\n\ntmpl('{ title || \"Untitled\" }', data)\ntmpl('Results are { results ? \"ready\" : \"loading\" }', data)\ntmpl('Today is { new Date() }', data)\ntmpl('{ message.length > 140 && \"Message is too long\" }', data)\ntmpl('This item got { Math.round(rating) } stars', data)\ntmpl('<h1>{ title }</h1>{ body }', data)\n\n\n// Falsy expressions in templates\n\nIn templates (as opposed to single expressions) all falsy values\nexcept zero (undefined/null/false) will default to empty string:\n\ntmpl('{ undefined } - { false } - { null } - { 0 }', {})\n// will return: \" - - - 0\"\n\n*/\n\n\nvar brackets = (function(orig, s, b) {\n  return function(x) {\n\n    // make sure we use the current setting\n    s = riot.settings.brackets || orig\n    if (b != s) b = s.split(' ')\n\n    // if regexp given, rewrite it with current brackets (only if differ from default)\n    return x && x.test\n      ? s == orig\n        ? x : RegExp(x.source\n                      .replace(/\\{/g, b[0].replace(/(?=.)/g, '\\\\'))\n                      .replace(/\\}/g, b[1].replace(/(?=.)/g, '\\\\')),\n                    x.global ? 'g' : '')\n\n      // else, get specific bracket\n      : b[x]\n\n  }\n})('{ }')\n\n\nvar tmpl = (function() {\n\n  var cache = {},\n      reVars = /(['\"\\/]).*?[^\\\\]\\1|\\.\\w*|\\w*:|\\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\\b|function *\\()|([a-z_$]\\w*)/gi\n              // [ 1               ][ 2  ][ 3 ][ 4                                                                                  ][ 5       ]\n              // find variable names:\n              // 1. skip quoted strings and regexps: \"a b\", 'a b', 'a \\'b\\'', /a b/\n              // 2. skip object properties: .name\n              // 3. skip object literals: name:\n              // 4. skip javascript keywords\n              // 5. match var name\n\n  // build a template (or get it from cache), render with data\n  return function(str, data) {\n    return str && (cache[str] = cache[str] || tmpl(str))(data)\n  }\n\n\n  // create a template instance\n\n  function tmpl(s, p) {\n\n    // default template string to {}\n    s = (s || (brackets(0) + brackets(1)))\n\n      // temporarily convert \\{ and \\} to a non-character\n      .replace(brackets(/\\\\{/g), '\\uFFF0')\n      .replace(brackets(/\\\\}/g), '\\uFFF1')\n\n    // split string to expression and non-expresion parts\n    p = split(s, extract(s, brackets(/{/), brackets(/}/)))\n\n    return new Function('d', 'return ' + (\n\n      // is it a single expression or a template? i.e. {x} or <b>{x}</b>\n      !p[0] && !p[2] && !p[3]\n\n        // if expression, evaluate it\n        ? expr(p[1])\n\n        // if template, evaluate all expressions in it\n        : '[' + p.map(function(s, i) {\n\n            // is it an expression or a string (every second part is an expression)\n          return i % 2\n\n              // evaluate the expressions\n              ? expr(s, true)\n\n              // process string parts of the template:\n              : '\"' + s\n\n                  // preserve new lines\n                  .replace(/\\n/g, '\\\\n')\n\n                  // escape quotes\n                  .replace(/\"/g, '\\\\\"')\n\n                + '\"'\n\n        }).join(',') + '].join(\"\")'\n      )\n\n      // bring escaped { and } back\n      .replace(/\\uFFF0/g, brackets(0))\n      .replace(/\\uFFF1/g, brackets(1))\n\n    + ';')\n\n  }\n\n\n  // parse { ... } expression\n\n  function expr(s, n) {\n    s = s\n\n      // convert new lines to spaces\n      .replace(/\\n/g, ' ')\n\n      // trim whitespace, brackets, strip comments\n      .replace(brackets(/^[{ ]+|[ }]+$|\\/\\*.+?\\*\\//g), '')\n\n    // is it an object literal? i.e. { key : value }\n    return /^\\s*[\\w- \"']+ *:/.test(s)\n\n      // if object literal, return trueish keys\n      // e.g.: { show: isOpen(), done: item.done } -> \"show done\"\n      ? '[' +\n\n          // extract key:val pairs, ignoring any nested objects\n          extract(s,\n\n              // name part: name:, \"name\":, 'name':, name :\n              /[\"' ]*[\\w- ]+[\"' ]*:/,\n\n              // expression part: everything upto a comma followed by a name (see above) or end of line\n              /,(?=[\"' ]*[\\w- ]+[\"' ]*:)|}|$/\n              ).map(function(pair) {\n\n                // get key, val parts\n                return pair.replace(/^[ \"']*(.+?)[ \"']*: *(.+?),? *$/, function(_, k, v) {\n\n                  // wrap all conditional parts to ignore errors\n                  return v.replace(/[^&|=!><]+/g, wrap) + '?\"' + k + '\":\"\",'\n\n                })\n\n              }).join('')\n\n        + '].join(\" \").trim()'\n\n      // if js expression, evaluate as javascript\n      : wrap(s, n)\n\n  }\n\n\n  // execute js w/o breaking on errors or undefined vars\n\n  function wrap(s, nonull) {\n    s = s.trim()\n    return !s ? '' : '(function(v){try{v='\n\n        // prefix vars (name => data.name)\n        + (s.replace(reVars, function(s, _, v) { return v ? '(d.'+v+'===undefined?'+(typeof window == 'undefined' ? 'global.' : 'window.')+v+':d.'+v+')' : s })\n\n          // break the expression if its empty (resulting in undefined value)\n          || 'x')\n      + '}catch(e){'\n      + '}finally{return '\n\n        // default to empty string for falsy values except zero\n        + (nonull === true ? '!v&&v!==0?\"\":v' : 'v')\n\n      + '}}).call(d)'\n  }\n\n\n  // split string by an array of substrings\n\n  function split(str, substrings) {\n    var parts = []\n    substrings.map(function(sub, i) {\n\n      // push matched expression and part before it\n      i = str.indexOf(sub)\n      parts.push(str.slice(0, i), sub)\n      str = str.slice(i + sub.length)\n    })\n\n    // push the remaining part\n    return parts.concat(str)\n  }\n\n\n  // match strings between opening and closing regexp, skipping any inner/nested matches\n\n  function extract(str, open, close) {\n\n    var start,\n        level = 0,\n        matches = [],\n        re = new RegExp('('+open.source+')|('+close.source+')', 'g')\n\n    str.replace(re, function(_, open, close, pos) {\n\n      // if outer inner bracket, mark position\n      if(!level && open) start = pos\n\n      // in(de)crease bracket level\n      level += open ? 1 : -1\n\n      // if outer closing bracket, grab the match\n      if(!level && close != null) matches.push(str.slice(start, pos+close.length))\n\n    })\n\n    return matches\n  }\n\n})()\n\n// { key, i in items} -> { key, i, items }\nfunction loopKeys(expr) {\n  var ret = { val: expr },\n      els = expr.split(/\\s+in\\s+/)\n\n  if (els[1]) {\n    ret.val = brackets(0) + els[1]\n    els = els[0].slice(brackets(0).length).trim().split(/,\\s*/)\n    ret.key = els[0]\n    ret.pos = els[1]\n  }\n\n  return ret\n}\n\nfunction mkitem(expr, key, val) {\n  var item = {}\n  item[expr.key] = key\n  if (expr.pos) item[expr.pos] = val\n  return item\n}\n\n\n/* Beware: heavy stuff */\nfunction _each(dom, parent, expr) {\n\n  remAttr(dom, 'each')\n\n  var template = dom.outerHTML,\n      prev = dom.previousSibling,\n      root = dom.parentNode,\n      rendered = [],\n      tags = [],\n      checksum\n\n  expr = loopKeys(expr)\n\n  function add(pos, item, tag) {\n    rendered.splice(pos, 0, item)\n    tags.splice(pos, 0, tag)\n  }\n\n  // clean template code\n  parent.one('update', function() {\n    root.removeChild(dom)\n\n  }).one('premount', function() {\n    if (root.stub) root = parent.root\n\n  }).on('update', function() {\n\n    var items = tmpl(expr.val, parent)\n    if (!items) return\n\n    // object loop. any changes cause full redraw\n    if (!Array.isArray(items)) {\n      var testsum = JSON.stringify(items)\n\n      if (testsum == checksum) return\n      checksum = testsum\n\n      // clear old items\n      each(tags, function(tag) { tag.unmount() })\n      rendered = []\n      tags = []\n\n      items = Object.keys(items).map(function(key) {\n        return mkitem(expr, key, items[key])\n      })\n\n    }\n\n    // unmount redundant\n    each(rendered, function(item) {\n      if (item instanceof Object) {\n        // skip existing items\n        if (items.indexOf(item) > -1) {\n          return\n        }\n      } else {\n        // find all non-objects\n        var newItems = arrFindEquals(items, item),\n            oldItems = arrFindEquals(rendered, item)\n\n        // if more or equal amount, no need to remove\n        if (newItems.length >= oldItems.length) {\n          return\n        }\n      }\n      var pos = rendered.indexOf(item),\n          tag = tags[pos]\n\n      if (tag) {\n        tag.unmount()\n        rendered.splice(pos, 1)\n        tags.splice(pos, 1)\n        // to let \"each\" know that this item is removed\n        return false\n      }\n\n    })\n\n    // mount new / reorder\n    var prevBase = [].indexOf.call(root.childNodes, prev) + 1\n    each(items, function(item, i) {\n\n      // start index search from position based on the current i\n      var pos = items.indexOf(item, i),\n          oldPos = rendered.indexOf(item, i)\n\n      // if not found, search backwards from current i position\n      pos < 0 && (pos = items.lastIndexOf(item, i))\n      oldPos < 0 && (oldPos = rendered.lastIndexOf(item, i))\n\n      if (!(item instanceof Object)) {\n        // find all non-objects\n        var newItems = arrFindEquals(items, item),\n            oldItems = arrFindEquals(rendered, item)\n\n        // if more, should mount one new\n        if (newItems.length > oldItems.length) {\n          oldPos = -1\n        }\n      }\n\n      // mount new\n      var nodes = root.childNodes\n      if (oldPos < 0) {\n        if (!checksum && expr.key) var _item = mkitem(expr, item, pos)\n\n        var tag = new Tag({ tmpl: template }, {\n          before: nodes[prevBase + pos],\n          parent: parent,\n          root: root,\n          item: _item || item\n        })\n\n        tag.mount()\n\n        add(pos, item, tag)\n        return true\n      }\n\n      // change pos value\n      if (expr.pos && tags[oldPos][expr.pos] != pos) {\n        tags[oldPos].one('update', function(item) {\n          item[expr.pos] = pos\n        })\n        tags[oldPos].update()\n      }\n\n      // reorder\n      if (pos != oldPos) {\n        root.insertBefore(nodes[prevBase + oldPos], nodes[prevBase + (pos > oldPos ? pos + 1 : pos)])\n        return add(pos, rendered.splice(oldPos, 1)[0], tags.splice(oldPos, 1)[0])\n      }\n\n    })\n\n    rendered = items.slice()\n\n  }).one('updated', function() {\n    walk(root, function(dom) {\n      each(dom.attributes, function(attr) {\n        if (/^(name|id)$/.test(attr.name)) parent[attr.value] = dom\n      })\n    })\n  })\n\n}\n\n\nfunction parseNamedElements(root, parent, childTags) {\n\n  walk(root, function(dom) {\n    if (dom.nodeType == 1) {\n      dom.isLoop = 0\n      if(dom.parentNode && dom.parentNode.isLoop) dom.isLoop = 1\n      if(dom.getAttribute('each')) dom.isLoop = 1\n      // custom child tag\n      var child = getTag(dom)\n\n      if (child && !dom.isLoop) {\n        var tag = new Tag(child, { root: dom, parent: parent }, dom.innerHTML),\n            namedTag = dom.getAttribute('name'),\n            tagName = namedTag && namedTag.indexOf(brackets(0)) < 0 ? namedTag : child.name,\n            ptag = parent,\n            cachedTag\n\n        while(!getTag(ptag.root)) {\n          if(!ptag.parent) break\n          ptag = ptag.parent\n        }\n        // fix for the parent attribute in the looped elements\n        tag.parent = ptag\n\n        cachedTag = ptag.tags[tagName]\n\n        // if there are multiple children tags having the same name\n        if (cachedTag) {\n          // if the parent tags property is not yet an array\n          // create it adding the first cached tag\n          if (!Array.isArray(cachedTag))\n            ptag.tags[tagName] = [cachedTag]\n          // add the new nested tag to the array\n          ptag.tags[tagName].push(tag)\n        } else {\n          ptag.tags[tagName] = tag\n        }\n\n        // empty the child node once we got its template\n        // to avoid that its children get compiled multiple times\n        dom.innerHTML = ''\n        childTags.push(tag)\n      }\n\n      if(!dom.isLoop)\n        each(dom.attributes, function(attr) {\n          if (/^(name|id)$/.test(attr.name)) parent[attr.value] = dom\n        })\n    }\n\n  })\n\n}\n\nfunction parseExpressions(root, tag, expressions) {\n\n  function addExpr(dom, val, extra) {\n    if (val.indexOf(brackets(0)) >= 0) {\n      var expr = { dom: dom, expr: val }\n      expressions.push(extend(expr, extra))\n    }\n  }\n\n  walk(root, function(dom) {\n    var type = dom.nodeType\n\n    // text node\n    if (type == 3 && dom.parentNode.tagName != 'STYLE') addExpr(dom, dom.nodeValue)\n    if (type != 1) return\n\n    /* element */\n\n    // loop\n    var attr = dom.getAttribute('each')\n    if (attr) { _each(dom, tag, attr); return false }\n\n    // attribute expressions\n    each(dom.attributes, function(attr) {\n      var name = attr.name,\n        bool = name.split('__')[1]\n\n      addExpr(dom, attr.value, { attr: bool || name, bool: bool })\n      if (bool) { remAttr(dom, name); return false }\n\n    })\n\n    // skip custom tags\n    if (getTag(dom)) return false\n\n  })\n\n}\nfunction Tag(impl, conf, innerHTML) {\n\n  var self = riot.observable(this),\n      opts = inherit(conf.opts) || {},\n      dom = mkdom(impl.tmpl),\n      parent = conf.parent,\n      expressions = [],\n      childTags = [],\n      root = conf.root,\n      item = conf.item,\n      fn = impl.fn,\n      tagName = root.tagName.toLowerCase(),\n      attr = {},\n      loopDom,\n      TAG_ATTRIBUTES = /([\\w\\-]+)\\s?=\\s?['\"]([^'\"]+)[\"']/gim\n\n  if (fn && root._tag) {\n    root._tag.unmount(true)\n  }\n\n  if(impl.attrs) {\n    var attrs = impl.attrs.match(TAG_ATTRIBUTES)\n\n    each(attrs, function(a) {\n      var kv = a.split(/\\s?=\\s?/)\n      root.setAttribute(kv[0], kv[1].replace(/['\"]/g, ''))\n    })\n\n  }\n  // keep a reference to the tag just created\n  // so we will be able to mount this tag multiple times\n  root._tag = this\n\n  // create a unique id to this tag\n  // it could be handy to use it also to improve the virtual dom rendering speed\n  this._id = fastAbs(~~(new Date().getTime() * Math.random()))\n\n  extend(this, { parent: parent, root: root, opts: opts, tags: {} }, item)\n\n  // grab attributes\n  each(root.attributes, function(el) {\n    attr[el.name] = el.value\n  })\n\n\n  if (dom.innerHTML && !/select/.test(tagName) && !/tbody/.test(tagName) && !/tr/.test(tagName))\n    // replace all the yield tags with the tag inner html\n    dom.innerHTML = replaceYield(dom.innerHTML, innerHTML)\n\n\n  // options\n  function updateOpts() {\n    each(Object.keys(attr), function(name) {\n      opts[name] = tmpl(attr[name], parent || self)\n    })\n  }\n\n  this.update = function(data, init) {\n    extend(self, data, item)\n    updateOpts()\n    self.trigger('update', item)\n    update(expressions, self, item)\n    self.trigger('updated')\n  }\n\n  this.mixin = function() {\n    each(arguments, function(mix) {\n      mix = 'string' == typeof mix ? riot.mixin(mix) : mix\n      each(Object.keys(mix), function(key) {\n        // bind methods to self\n        if ('init' != key)\n          self[key] = 'function' == typeof mix[key] ? mix[key].bind(self) : mix[key]\n      })\n      // init method will be called automatically\n      if (mix.init) mix.init.bind(self)()\n    })\n  }\n\n  this.mount = function() {\n\n    updateOpts()\n\n    // initialiation\n    fn && fn.call(self, opts)\n\n    toggle(true)\n\n    // parse layout after init. fn may calculate args for nested custom tags\n    parseExpressions(dom, self, expressions)\n\n    if (!self.parent) self.update()\n\n    // internal use only, fixes #403\n    self.trigger('premount')\n\n    if (fn) {\n      while (dom.firstChild) root.appendChild(dom.firstChild)\n\n    } else {\n      loopDom = dom.firstChild\n      root.insertBefore(loopDom, conf.before || null) // null needed for IE8\n    }\n\n    if (root.stub) self.root = root = parent.root\n\n    // if it's not a child tag we can trigger its mount event\n    if (!self.parent) self.trigger('mount')\n    // otherwise we need to wait that the parent event gets triggered\n    else self.parent.one('mount', function() { self.trigger('mount') })\n  }\n\n\n  this.unmount = function(keepRootTag) {\n    var el = fn ? root : loopDom,\n        p = el.parentNode\n\n    if (p) {\n\n      if (parent) {\n        // remove this tag from the parent tags object\n        // if there are multiple nested tags with same name..\n        // remove this element form the array\n        if (Array.isArray(parent.tags[tagName])) {\n          each(parent.tags[tagName], function(tag, i) {\n            if (tag._id == self._id)\n              parent.tags[tagName].splice(i, 1)\n          })\n        } else\n          // otherwise just delete the tag instance\n          parent.tags[tagName] = undefined\n      } else {\n        while (el.firstChild) el.removeChild(el.firstChild)\n      }\n\n      if (!keepRootTag)\n        p.removeChild(el)\n\n    }\n\n\n    self.trigger('unmount')\n    toggle()\n    self.off('*')\n    // somehow ie8 does not like `delete root._tag`\n    root._tag = null\n\n  }\n\n  function toggle(isMount) {\n\n    // mount/unmount children\n    each(childTags, function(child) { child[isMount ? 'mount' : 'unmount']() })\n\n    // listen/unlisten parent (events flow one way from parent to children)\n    if (parent) {\n      var evt = isMount ? 'on' : 'off'\n      parent[evt]('update', self.update)[evt]('unmount', self.unmount)\n    }\n  }\n\n  // named elements available for fn\n  parseNamedElements(dom, this, childTags)\n\n\n}\n\nfunction setEventHandler(name, handler, dom, tag, item) {\n\n  dom[name] = function(e) {\n\n    // cross browser event fix\n    e = e || window.event\n    e.which = e.which || e.charCode || e.keyCode\n    e.target = e.target || e.srcElement\n    e.currentTarget = dom\n    e.item = item\n\n    // prevent default behaviour (by default)\n    if (handler.call(tag, e) !== true && !/radio|check/.test(dom.type)) {\n      e.preventDefault && e.preventDefault()\n      e.returnValue = false\n    }\n\n    if (!e.preventUpdate) {\n      var el = item ? tag.parent : tag\n      el.update()\n    }\n\n  }\n\n}\n\n// used by if- attribute\nfunction insertTo(root, node, before) {\n  if (root) {\n    root.insertBefore(before, node)\n    root.removeChild(node)\n  }\n}\n\n// item = currently looped item\nfunction update(expressions, tag, item) {\n\n  each(expressions, function(expr, i) {\n\n    var dom = expr.dom,\n        attrName = expr.attr,\n        value = tmpl(expr.expr, tag),\n        parent = expr.dom.parentNode\n\n    if (value == null) value = ''\n\n    // leave out riot- prefixes from strings inside textarea\n    if (parent && parent.tagName == 'TEXTAREA') value = value.replace(/riot-/g, '')\n\n    // no change\n    if (expr.value === value) return\n    expr.value = value\n\n    // text node\n    if (!attrName) return dom.nodeValue = value.toString()\n\n    // remove original attribute\n    remAttr(dom, attrName)\n\n    // event handler\n    if (typeof value == 'function') {\n      setEventHandler(attrName, value, dom, tag, item)\n\n    // if- conditional\n    } else if (attrName == 'if') {\n      var stub = expr.stub\n\n      // add to DOM\n      if (value) {\n        stub && insertTo(stub.parentNode, stub, dom)\n\n      // remove from DOM\n      } else {\n        stub = expr.stub = stub || document.createTextNode('')\n        insertTo(dom.parentNode, dom, stub)\n      }\n\n    // show / hide\n    } else if (/^(show|hide)$/.test(attrName)) {\n      if (attrName == 'hide') value = !value\n      dom.style.display = value ? '' : 'none'\n\n    // field value\n    } else if (attrName == 'value') {\n      dom.value = value\n\n    // <img src=\"{ expr }\">\n    } else if (attrName.slice(0, 5) == 'riot-') {\n      attrName = attrName.slice(5)\n      value ? dom.setAttribute(attrName, value) : remAttr(dom, attrName)\n\n    } else {\n      if (expr.bool) {\n        dom[attrName] = value\n        if (!value) return\n        value = attrName\n      }\n\n      if (typeof value != 'object') dom.setAttribute(attrName, value)\n\n    }\n\n  })\n\n}\n\nfunction each(els, fn) {\n  for (var i = 0, len = (els || []).length, el; i < len; i++) {\n    el = els[i]\n    // return false -> remove current item during loop\n    if (el != null && fn(el, i) === false) i--\n  }\n  return els\n}\n\nfunction remAttr(dom, name) {\n  dom.removeAttribute(name)\n}\n\nfunction fastAbs(nr) {\n  return (nr ^ (nr >> 31)) - (nr >> 31)\n}\n\n// max 2 from objects allowed\nfunction extend(obj, from, from2) {\n  from && each(Object.keys(from), function(key) {\n    obj[key] = from[key]\n  })\n  return from2 ? extend(obj, from2) : obj\n}\n\nfunction checkIE() {\n  if (window) {\n    var ua = navigator.userAgent\n    var msie = ua.indexOf('MSIE ')\n    if (msie > 0) {\n      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10)\n    }\n    else {\n      return 0\n    }\n  }\n}\n\nfunction optionInnerHTML(el, html) {\n  var opt = document.createElement('option'),\n      valRegx = /value=[\\\"'](.+?)[\\\"']/,\n      selRegx = /selected=[\\\"'](.+?)[\\\"']/,\n      valuesMatch = html.match(valRegx),\n      selectedMatch = html.match(selRegx)\n\n  opt.innerHTML = html\n\n  if (valuesMatch) {\n    opt.value = valuesMatch[1]\n  }\n\n  if (selectedMatch) {\n    opt.setAttribute('riot-selected', selectedMatch[1])\n  }\n\n  el.appendChild(opt)\n}\n\nfunction tbodyInnerHTML(el, html, tagName) {\n  var div = document.createElement('div')\n  div.innerHTML = '<table>' + html + '</table>'\n\n  if (/td|th/.test(tagName)) {\n    el.appendChild(div.firstChild.firstChild.firstChild.firstChild)\n  } else {\n    el.appendChild(div.firstChild.firstChild.firstChild)\n  }\n}\n\nfunction mkdom(template) {\n  var tagName = template.trim().slice(1, 3).toLowerCase(),\n      rootTag = /td|th/.test(tagName) ? 'tr' : tagName == 'tr' ? 'tbody' : 'div',\n      el = mkEl(rootTag)\n\n  el.stub = true\n\n  if (tagName === 'op' && ieVersion && ieVersion < 10) {\n    optionInnerHTML(el, template)\n  } else if ((rootTag === 'tbody' || rootTag === 'tr') && ieVersion && ieVersion < 10) {\n    tbodyInnerHTML(el, template, tagName)\n  } else\n    el.innerHTML = template\n\n  return el\n}\n\nfunction walk(dom, fn) {\n  if (dom) {\n    if (fn(dom) === false) walk(dom.nextSibling, fn)\n    else {\n      dom = dom.firstChild\n\n      while (dom) {\n        walk(dom, fn)\n        dom = dom.nextSibling\n      }\n    }\n  }\n}\n\nfunction mkEl(name) {\n  return document.createElement(name)\n}\n\nfunction replaceYield (tmpl, innerHTML) {\n  return tmpl.replace(/<(yield)\\/?>(<\\/\\1>)?/gim, innerHTML || '')\n}\n\nfunction $$(selector, ctx) {\n  ctx = ctx || document\n  return ctx.querySelectorAll(selector)\n}\n\nfunction arrDiff(arr1, arr2) {\n  return arr1.filter(function(el) {\n    return arr2.indexOf(el) < 0\n  })\n}\n\nfunction arrFindEquals(arr, el) {\n  return arr.filter(function (_el) {\n    return _el === el\n  })\n}\n\nfunction inherit(parent) {\n  function Child() {}\n  Child.prototype = parent\n  return new Child()\n}\n/**\n *\n * Hacks needed for the old internet explorer versions [lower than IE10]\n *\n */\n\nvar ieVersion = checkIE()\n\nfunction checkIE() {\n  if (window) {\n    var ua = navigator.userAgent\n    var msie = ua.indexOf('MSIE ')\n    if (msie > 0) {\n      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10)\n    }\n    else {\n      return 0\n    }\n  }\n}\n\nfunction tbodyInnerHTML(el, html, tagName) {\n  var div = mkEl('div'),\n      loops = /td|th/.test(tagName) ? 3 : 2,\n      child\n\n  div.innerHTML = '<table>' + html + '</table>'\n  child = div.firstChild\n\n  while(loops--) {\n    child = child.firstChild\n  }\n\n  el.appendChild(child)\n\n}\n\nfunction optionInnerHTML(el, html) {\n  var opt = mkEl('option'),\n      valRegx = /value=[\\\"'](.+?)[\\\"']/,\n      selRegx = /selected=[\\\"'](.+?)[\\\"']/,\n      valuesMatch = html.match(valRegx),\n      selectedMatch = html.match(selRegx)\n\n  opt.innerHTML = html\n\n  if (valuesMatch) {\n    opt.value = valuesMatch[1]\n  }\n\n  if (selectedMatch) {\n    opt.setAttribute('riot-selected', selectedMatch[1])\n  }\n\n  el.appendChild(opt)\n}\n\n/*\n Virtual dom is an array of custom tags on the document.\n Updates and unmounts propagate downwards from parent to children.\n*/\n\nvar virtualDom = [],\n    tagImpl = {},\n    styleNode\n\n\nfunction getTag(dom) {\n  return tagImpl[dom.getAttribute('riot-tag') || dom.tagName.toLowerCase()]\n}\n\nfunction injectStyle(css) {\n\n  styleNode = styleNode || mkEl('style')\n\n  if (!document.head) return\n\n  if(styleNode.styleSheet)\n    styleNode.styleSheet.cssText += css\n  else\n    styleNode.innerHTML += css\n\n  if (!styleNode._rendered)\n    if (styleNode.styleSheet)\n      document.body.appendChild(styleNode)\n    else\n      document.head.appendChild(styleNode)\n\n  styleNode._rendered = true\n\n}\n\nfunction mountTo(root, tagName, opts) {\n  var tag = tagImpl[tagName],\n      innerHTML = root.innerHTML\n\n  // clear the inner html\n  root.innerHTML = ''\n\n  if (tag && root) tag = new Tag(tag, { root: root, opts: opts }, innerHTML)\n\n  if (tag && tag.mount) {\n    tag.mount()\n    virtualDom.push(tag)\n    return tag.on('unmount', function() {\n      virtualDom.splice(virtualDom.indexOf(tag), 1)\n    })\n  }\n\n}\n\nriot.tag = function(name, html, css, attrs, fn) {\n  if (typeof attrs == 'function') {\n    fn = attrs\n    if(/^[\\w\\-]+\\s?=/.test(css)) {attrs = css; css = ''} else attrs = ''\n  }\n  if (typeof css == 'function') fn = css\n  else if (css) injectStyle(css)\n  tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\nriot.mount = function(selector, tagName, opts) {\n\n  var el,\n      selctAllTags = function() {\n        var keys = Object.keys(tagImpl)\n        var list = keys.join(', ')\n        each(keys, function(t) {\n          list += ', *[riot-tag=\"'+ t.trim() + '\"]'\n        })\n        return list\n      },\n      allTags,\n      tags = []\n\n  if (typeof tagName == 'object') { opts = tagName; tagName = 0 }\n\n  // crawl the DOM to find the tag\n  if(typeof selector == 'string') {\n    if (selector == '*') {\n      // select all the tags registered\n      // and also the tags found with the riot-tag attribute set\n      selector = allTags = selctAllTags()\n    } else {\n      selector.split(',').map(function(t) {\n        selector += ', *[riot-tag=\"'+ t.trim() + '\"]'\n      })\n\n    }\n    // or just the ones named like the selector\n    el = $$(selector)\n  }\n  // probably you have passed already a tag or a NodeList\n  else\n    el = selector\n\n  // select all the registered and mount them inside their root elements\n  if (tagName == '*') {\n    // get all custom tags\n    tagName = allTags || selctAllTags()\n    // if the root el it's just a single tag\n    if (el.tagName) {\n      el = $$(tagName, el)\n    } else {\n      var nodeList = []\n      // select all the children for all the different root elements\n      each(el, function(tag) {\n        nodeList = $$(tagName, tag)\n      })\n      el = nodeList\n    }\n    // get rid of the tagName\n    tagName = 0\n  }\n\n  function push(root) {\n    if(tagName && !root.getAttribute('riot-tag')) root.setAttribute('riot-tag', tagName)\n\n    var name = tagName || root.getAttribute('riot-tag') || root.tagName.toLowerCase(),\n        tag = mountTo(root, name, opts)\n\n    if (tag) tags.push(tag)\n  }\n\n  // DOM node\n  if (el.tagName)\n    push(selector)\n  // selector or NodeList\n  else\n    each(el, push)\n\n  return tags\n\n}\n\n// update everything\nriot.update = function() {\n  return each(virtualDom, function(tag) {\n    tag.update()\n  })\n}\n\n// @deprecated\nriot.mountTo = riot.mount\n\n\n  // share methods for other riot parts, e.g. compiler\n  riot.util = { brackets: brackets, tmpl: tmpl }\n\n  // support CommonJS, AMD & browser\n  if (typeof exports === 'object')\n    module.exports = riot\n  else if (typeof define === 'function' && define.amd)\n    define(function() { return riot })\n  else\n    window.riot = riot\n\n})(typeof window != 'undefined' ? window : undefined);\n","var riot = require('riot');\nriot.tag('item', '<span class=\"index\">{ opts.index }.</span> <p> <a class=\"title\" href=\"{ href() }\" target=\"_blank\">{ itemdata.title }</a> <span class=\"domain\" show=\"{ showDomain() }\"> ({ filters.domain(itemdata.url) }) </span> </p> <p class=\"subtext\"> <span show=\"{ showInfo() }\"> { itemdata.score } points by <a href=\"#user/{ itemdata.by }\">{ itemdata.by }</a> </span> { filters.fromNow(itemdata.time) } ago <span class=\"comments-link\" show=\"{ showInfo() }\"> | <a href=\"#item/{ itemdata.id }\">comments</a> </span> </p>', function(opts) {\n  var self = this\n  self.itemdata = opts.data\n\n  this.href = function() {\n    return self.itemdata.url || ('#/item/' + self.itemdata.id)\n  }.bind(this);\n\n  this.showInfo = function() {\n    return self.itemdata.type === 'story' || self.itemdata.type === 'poll'\n  }.bind(this);\n\n  this.showDomain = function() {\n    return self.itemdata.type === 'story'\n  }.bind(this);\n  \n});\n","var riot = require('riot');\nriot.tag('comment', '<li show=\"{ data.text }\"> <div class=\"comhead\"> <a class=\"toggle\" onclick=\"{ toggle }\">{ open ? \\'[-]\\' : \\'[+]\\' }</a> <a href=\"#user/{ data.by }\">{ data.by }</a> { filters.fromNow(data.time) } ago </div> <div class=\"comment-content\" name=\"commentcontent\" show=\"{ open }\"></div> <ul class=\"child-comments\" if=\"{ data.kids }\" show=\"{ open }\"> <div each=\"{ c, i in comments }\"> <comment data=\"{ c }\"></comment> <div> </ul> </li>', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.data = opts.data\n  self.open = true\n  self.commentcontent.innerHTML = self.data.text\n\n  store.fetchItems(self.data.kids, function(result) {\n    self.comments = result\n    self.update()\n  })\n\n  this.toggle = function(e) {\n    this.open = !this.open\n  }.bind(this);\n  \n});\n","//var Firebase = require('firebase')\nvar api = new Firebase('https://hacker-news.firebaseio.com/v0')\nvar storiesPerPage = 30\nvar cachedStoryIds = []\nvar Emitter = require('events').EventEmitter\nvar store = module.exports = new Emitter()\n\n/**\n * Subscribe to real time updates of the top 100 stories,\n * and cache the IDs locally.\n */\n\napi.child('topstories').on('value', function (snapshot) {\n  cachedStoryIds = snapshot.val()\n  store.emit('update')\n})\n\n/**\n * Fetch an item data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(item)\n */\n\nstore.fetchItem = function (id, cb) {\n  api.child('item/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch a user data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(user)\n */\n\nstore.fetchUser = function (id, cb) {\n  api.child('user/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch the given list of items.\n *\n * @param {Array<Number>} ids\n * @param {Function} cb(items)\n */\n\nstore.fetchItems = function (ids, cb) {\n  if (!ids || !ids.length) return cb([])\n  var items = []\n  ids.forEach(function (id) {\n    store.fetchItem(id, addItem)\n  })\n  function addItem (item) {\n    items.push(item)\n    if (items.length >= ids.length) {\n      cb(items)\n    }\n  }\n}\n\n/**\n * Fetch items for the given page.\n *\n * @param {Number} page\n * @param {Function} cb(stories)\n */\n\nstore.fetchItemsByPage = function (page, cb) {\n  var start = (page - 1) * storiesPerPage\n  var end = page * storiesPerPage\n  var ids = cachedStoryIds.slice(start, end)\n  store.fetchItems(ids, cb)\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n"]}