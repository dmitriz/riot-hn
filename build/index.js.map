{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/index.js","src/filters.js","src/app.html","node_modules/riot/riot.js","src/views/user-view.html","src/views/item-view.html","src/views/news-view.html","src/store.js","src/components/item.html","src/components/comment.html","node_modules/browserify/node_modules/events/events.js"],"names":["require","mount","parser","document","createElement","window","filters","fromNow","time","between","Date","now","Number","domain","url","href","hostname","riot","module","exports","tag2","opts","self","this","currentView","loadView","viewName","id","unmount","data","bind","studyRoute","view","route","on","start","exec","undefined","mkitem","expr","key","val","item","pos","unmountRedundant","items","tags","i","length","j","t","splice","moveNestedTags","child","Object","keys","forEach","tagName","tag","isArray","each","moveChildTag","addVirtual","src","target","el","_root","_virts","sib","nextSibling","insertBefore","appendChild","push","moveVirtual","len","_each","dom","parent","remAttr","checksum","mustReorder","getAttr","T_STRING","getTagName","impl","__tagImpl","tmpl","outerHTML","useRoot","SPECIAL_TAGS_REGEX","test","root","parentNode","isSpecialTag","ref","createTextNode","getTag","oldItems","isVirtual","loopKeys","one","removeChild","stub","frag","createDocumentFragment","JSON","stringify","map","_mustReorder","oldPos","indexOf","Tag","isLoop","hasImpl","cloneNode","innerHTML","firstChild","update","childNodes","_item","defineProperty","slice","parseNamedElements","childTags","forceParsingNamed","walk","nodeType","initChildTag","setNamed","parseExpressions","expressions","addExpr","extra","hasExpr","extend","type","nodeValue","attr","attributes","name","bool","split","value","conf","updateOpts","ctx","toCamel","normalizeData","T_UNDEF","isWritable","inheritFromParent","k","mustSync","contains","RESERVED_WORDS_BLACKLIST","propsInSyncWithParent","toggle","isMount","evt","observable","inherit","mkdom","cleanUpData","fn","toLowerCase","_tag","isMounted","__uid","replaceYield","T_OBJECT","trigger","arguments","mix","mixin","isFunction","init","call","attrs","walkAttributes","v","setAttr","isInStub","keepRootTag","ptag","p","__virtualDom","getImmediateCustomParentTag","_riot_id","off","setEventHandler","handler","e","_parent","event","currentTarget","srcElement","which","charCode","keyCode","preventDefault","returnValue","preventUpdate","insertTo","node","before","attrName","replace","add","remove","inStub","style","display","startsWith","RIOT_PREFIX","RIOT_TAG","els","T_FUNCTION","removeAttribute","string","match","toUpperCase","getAttribute","setAttribute","addChildTag","cachedTag","newPos","options","enumerable","writable","configurable","namedTag","obj","args","arr","a","Array","props","getOwnPropertyDescriptor","o","html","m","re","mkEl","$$","selector","querySelectorAll","$","querySelector","Child","prototype","getNamedKey","isArr","str","mountTo","_innerHTML","version","settings","IE_VERSION","documentMode","callbacks","onEachEvent","events","typed","cb","arglen","apply","fns","busy","concat","all","DEFAULT_PARSER","path","DEFAULT_SECOND_PARSER","filter","RegExp","REPLACE","Router","central","s","normalize","getPathFromRoot","loc","RE_ORIGIN","getPathFromBase","base","emit","force","current","TRIGGER","click","metaKey","ctrlKey","shiftKey","defaultPrevented","nodeName","HAS_ATTRIBUTE","go","title","doc","history","pushState","secondParser","EVENT_LISTENER","REMOVE_EVENT_LISTENER","ADD_EVENT_LISTENER","POPSTATE","win","location","prot","clickEvent","ontouchstart","started","first","second","r","some","action","mainRouter","create","newSubRouter","stop","arg","fn2","query","q","_","brackets","UNDEF","_regExp","source","flags","_loopback","_rewrite","_pairs","global","REGLOB","_reset","pair","DEFAULT","bp","_regex","Error","S_QBSRC","_brackets","cachedBrackets","_set","reOrIdx","MLCOMMS","STRINGS","FINDBRACES","(","[","{","unescapeStr","isexpr","parts","skipBraces","ch","recch","level","lastIndex","index","trim","array","set","R_STRINGS","R_MLCOMMS","S_QBLOCKS","_tmpl","_cache","_create","_logErr","err","errorHandler","riotData","_getTmpl","Function","qstr","list","_parseExpr","join","RE_QBMARK","asText","jsb","lv","ir","RE_QBLOCK","div","cnt","CS_IDENT","rightContext","_wrapExpr","tb","FALSE","JS_VARNAME","mvar","JS_CONTEXT","parse","checkIE","_mkdom","rootTag","rootEls","GENERIC","ie9elem","select","tr","th","td","tbody","col","injectStyle","styleNode","placeholder","replaceChild","getElementsByTagName","styleSheet","css","cssText","util","mixins","bpair","addRiotTags","selectAllTags","pushTags","last","allTags","nodeList","_el","define","amd","store","fetchUser","user","about","fetchComments","fetchItems","kids","comments","fetchPollOptions","pollOptions","fetchItem","page","fetchNews","fetchItemsByPage","displayPage","removeListener","api","Firebase","storiesPerPage","cachedStoryIds","Emitter","EventEmitter","snapshot","once","ids","addItem","end","itemdata","showInfo","showDomain","open","commentcontent","text","result","_events","_maxListeners","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","TypeError","er","listeners","error","addListener","listener","newListener","warned","console","trace","g","fired","position","removeAllListeners","ret","listenerCount","evlistener","emitter"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","require('./filters.js')\nrequire('./app.html')\nrequire('riot').mount('app')\n","var parser = document.createElement('a')\n\nwindow.filters = {\n  fromNow: function (time) {\n    var between = Date.now() / 1000 - Number(time)\n    if (between < 3600) {\n      return ~~(between / 60) + ' minutes'\n    } else if (between < 86400) {\n      return ~~(between / 3600) + ' hours'\n    } else {\n      return ~~(between / 86400) + ' days'\n    }\n  },\n  domain: function (url) {\n    parser.href = url\n    return parser.hostname\n  }\n}\n","var riot = require('riot');\nmodule.exports = riot.tag2('app', '<div id=\"header\"> <a id=\"yc\" href=\"http://www.ycombinator.com\"> <img src=\"https://news.ycombinator.com/y18.gif\"> </a> <h1><a href=\"#\">Hacker News</a></h1> <span class=\"source\"> Built with <a href=\"https://muut.com/riotjs/\" target=\"_blank\">Riot.js</a> | <a href=\"https://github.com/txchen/riot-hn\" target=\"_blank\">Source</a> </span> </div> <div id=\"hnview\"></div>', '', '', function(opts) {\n  require('./views/user-view.html')\n  require('./views/item-view.html')\n  require('./views/news-view.html')\n  var self = this\n  self.currentView = null\n\n  this.loadView = function(viewName, id) {\n    if (self.currentView) {\n      self.currentView.unmount(true)\n    }\n    self.currentView = riot.mount('div#hnview', viewName, {data: id})[0]\n  }.bind(this)\n\n  this.studyRoute = function(view, id) {\n    switch(view) {\n    case 'user':\n      self.loadView('user-view', id)\n      break\n    case 'item':\n      self.loadView('item-view', id)\n      break\n    case 'news':\n      self.loadView('news-view', id)\n      break\n    default:\n      riot.route('news/1')\n      self.loadView('news-view', 1)\n    }\n  }.bind(this)\n\n  riot.route(self.studyRoute)\n  this.on('mount', function() {\n    riot.route.start()\n    riot.route.exec()\n  })\n});\n","/* Riot v2.3.0, @license MIT, (c) 2015 Muut Inc. + contributors */\n\n;(function(window, undefined) {\n  'use strict';\nvar riot = { version: 'v2.3.0', settings: {} },\n  // be aware, internal usage\n  // ATTENTION: prefix the global dynamic variables with `__`\n\n  // counter to give a unique id to all the Tag instances\n  __uid = 0,\n  // tags instances cache\n  __virtualDom = [],\n  // tags implementation cache\n  __tagImpl = {},\n\n  /**\n   * Const\n   */\n  // riot specific prefixes\n  RIOT_PREFIX = 'riot-',\n  RIOT_TAG = RIOT_PREFIX + 'tag',\n\n  // for typeof == '' comparisons\n  T_STRING = 'string',\n  T_OBJECT = 'object',\n  T_UNDEF  = 'undefined',\n  T_FUNCTION = 'function',\n  // special native tags that cannot be treated like the others\n  SPECIAL_TAGS_REGEX = /^(?:opt(ion|group)|tbody|col|t[rhd])$/,\n  RESERVED_WORDS_BLACKLIST = ['_item', '_id', '_parent', 'update', 'root', 'mount', 'unmount', 'mixin', 'isMounted', 'isLoop', 'tags', 'parent', 'opts', 'trigger', 'on', 'off', 'one'],\n\n  // version# for IE 8-11, 0 for others\n  IE_VERSION = (window && window.document || {}).documentMode | 0\n/* istanbul ignore next */\nriot.observable = function(el) {\n\n  /**\n   * Extend the original object or create a new empty one\n   * @type { Object }\n   */\n\n  el = el || {}\n\n  /**\n   * Private variables and methods\n   */\n\n  var callbacks = {},\n    onEachEvent = function(e, fn) { e.replace(/\\S+/g, fn) },\n    defineProperty = function (key, value) {\n      Object.defineProperty(el, key, {\n        value: value,\n        enumerable: false,\n        writable: false,\n        configurable: false\n      })\n    }\n\n  /**\n   * Listen to the given space separated list of `events` and execute the `callback` each time an event is triggered.\n   * @param  { String } events - events ids\n   * @param  { Function } fn - callback function\n   * @returns { Object } el\n   */\n\n  defineProperty('on', function(events, fn) {\n    if (typeof fn != 'function')  return el\n\n    onEachEvent(events, function(name, pos) {\n      (callbacks[name] = callbacks[name] || []).push(fn)\n      fn.typed = pos > 0\n    })\n\n    return el\n  })\n\n  /**\n   * Removes the given space separated list of `events` listeners\n   * @param   { String } events - events ids\n   * @param   { Function } fn - callback function\n   * @returns { Object } el\n   */\n\n  defineProperty('off', function(events, fn) {\n    if (events == '*') callbacks = {}\n    else {\n      onEachEvent(events, function(name) {\n        if (fn) {\n          var arr = callbacks[name]\n          for (var i = 0, cb; cb = arr && arr[i]; ++i) {\n            if (cb == fn) arr.splice(i--, 1)\n          }\n        } else delete callbacks[name]\n      })\n    }\n    return el\n  })\n\n  /**\n   * Listen to the given space separated list of `events` and execute the `callback` at most once\n   * @param   { String } events - events ids\n   * @param   { Function } fn - callback function\n   * @returns { Object } el\n   */\n\n  defineProperty('one', function(events, fn) {\n    function on() {\n      el.off(events, on)\n\n      // V8 performance optimization\n      // https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#3-managing-arguments\n      var arglen = arguments.length\n      var args = new Array(arglen)\n      for (var i = 0; i < arglen; i++) {\n        args[i] = arguments[i]\n      }\n\n      fn.apply(el, args)\n    }\n    return el.on(events, on)\n  })\n\n  /**\n   * Execute all callback functions that listen to the given space separated list of `events`\n   * @param   { String } events - events ids\n   * @returns { Object } el\n   */\n\n  defineProperty('trigger', function(events) {\n    // V8 performance optimization\n    // https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#3-managing-arguments\n    var arglen = arguments.length - 1\n    var args = new Array(arglen)\n    for (var i = 0; i < arglen; i++) {\n      args[i] = arguments[i + 1] // skip first argument\n    }\n\n    onEachEvent(events, function(name) {\n\n      var fns = (callbacks[name] || []).slice(0)\n\n      for (var i = 0, fn; fn = fns[i]; ++i) {\n        if (fn.busy) return\n        fn.busy = 1\n\n        try {\n          fn.apply(el, fn.typed ? [name].concat(args) : args)\n        } catch (e) { /* error */}\n        if (fns[i] !== fn) { i-- }\n        fn.busy = 0\n      }\n\n      if (callbacks.all && name != 'all')\n        el.trigger.apply(el, ['all', name].concat(args))\n\n    })\n\n    return el\n  })\n\n  return el\n\n}\n/* istanbul ignore next */\n;(function(riot) { if (!window) return;\n\n/**\n * Simple client-side router\n * @module riot-route\n */\n\n\nvar RE_ORIGIN = /^.+?\\/+[^\\/]+/,\n  EVENT_LISTENER = 'EventListener',\n  REMOVE_EVENT_LISTENER = 'remove' + EVENT_LISTENER,\n  ADD_EVENT_LISTENER = 'add' + EVENT_LISTENER,\n  HAS_ATTRIBUTE = 'hasAttribute',\n  REPLACE = 'replace',\n  POPSTATE = 'popstate',\n  TRIGGER = 'trigger',\n  win = window,\n  doc = document,\n  loc = win.history.location || win.location, // see html5-history-api\n  prot = Router.prototype, // to minify more\n  clickEvent = doc && doc.ontouchstart ? 'touchstart' : 'click',\n  started = false,\n  central = riot.observable(),\n  base, current, parser, secondParser\n\n/**\n * Default parser. You can replace it via router.parser method.\n * @param {string} path - current path (normalized)\n * @returns {array} array\n */\nfunction DEFAULT_PARSER(path) {\n  return path.split(/[/?#]/)\n}\n\n/**\n * Default parser (second). You can replace it via router.parser method.\n * @param {string} path - current path (normalized)\n * @param {string} filter - filter string (normalized)\n * @returns {array} array\n */\nfunction DEFAULT_SECOND_PARSER(path, filter) {\n  var re = new RegExp('^' + filter[REPLACE](/\\*/g, '([^/?#]+?)')[REPLACE](/\\.\\./, '.*') + '$'),\n    args = path.match(re)\n\n  if (args) return args.slice(1)\n}\n\n/**\n * Router class\n */\nfunction Router() {\n  this.$ = []\n  riot.observable(this) // make it observable\n  central.on('stop', this.s.bind(this))\n  central.on('emit', this.e.bind(this))\n}\n\nfunction normalize(path) {\n  return path[REPLACE](/^\\/|\\/$/, '')\n}\n\n/**\n * Get the part after domain name\n * @param {string} href - fullpath\n * @returns {string} path from root\n */\nfunction getPathFromRoot(href) {\n  return (href || loc.href)[REPLACE](RE_ORIGIN, '')\n}\n\n/**\n * Get the part after base\n * @param {string} href - fullpath\n * @returns {string} path from base\n */\nfunction getPathFromBase(href) {\n  return base[0] == '#'\n    ? (href || loc.href).split(base)[1] || ''\n    : getPathFromRoot(href)[REPLACE](base, '')\n}\n\nfunction emit(force) {\n  var path = getPathFromBase()\n  if (force || path != current) {\n    central[TRIGGER]('emit', path)\n    current = path\n  }\n}\n\nfunction click(e) {\n  if (\n    e.which != 1 // not left click\n    || e.metaKey || e.ctrlKey || e.shiftKey // or meta keys\n    || e.defaultPrevented // or default prevented\n  ) return\n\n  var el = e.target\n  while (el && el.nodeName != 'A') el = el.parentNode\n  if (\n    !el || el.nodeName != 'A' // not A tag\n    || el[HAS_ATTRIBUTE]('download') // has download attr\n    || !el[HAS_ATTRIBUTE]('href') // has no href attr\n    || el.target && el.target != '_self' // another window or frame\n    || el.href.indexOf(loc.href.match(RE_ORIGIN)[0]) == -1 // cross origin\n  ) return\n\n  if (el.href != loc.href) {\n    if (el.href.split('#')[0] == loc.href.split('#')[0]) return // internal jump\n    go(getPathFromBase(el.href), el.title || doc.title)\n  }\n  e.preventDefault()\n}\n\n/**\n * Go to the path\n * @param {string} path - destination path\n * @param {string} title - page title\n */\nfunction go(path, title) {\n  title = title || doc.title\n  // browsers ignores the second parameter `title`\n  history.pushState(null, title, base + path)\n  // so we need to set it manually\n  doc.title = title\n  emit()\n}\n\n/**\n * Go to path or set action\n * a single string:                go there\n * two strings:                    go there with setting a title\n * a single function:              set an action on the default route\n * a string/RegExp and a function: set an action on the route\n * @param {(string|function)} first - path / action / filter\n * @param {(string|RegExp|function)} second - title / action\n */\nprot.m = function(first, second) {\n  if (first[0] && (!second || second[0])) go(first, second)\n  else if (second) this.r(first, second)\n  else this.r('@', first)\n}\n\n/**\n * Stop routing\n */\nprot.s = function() {\n  this.off('*')\n  this.$ = []\n}\n\n/**\n * Emit\n * @param {string} path - path\n */\nprot.e = function(path) {\n  this.$.concat('@').some(function(filter) {\n    var args = (filter == '@' ? parser : secondParser)(normalize(path), normalize(filter))\n    if (args) {\n      this[TRIGGER].apply(null, [filter].concat(args))\n      return true // exit from loop\n    }\n  }, this)\n}\n\n/**\n * Register route\n * @param {string} filter - filter for matching to url\n * @param {function} action - action to register\n */\nprot.r = function(filter, action) {\n  if (filter != '@') this.$.push(filter)\n  this.on(filter, action)\n}\n\nvar mainRouter = new Router()\nvar route = mainRouter.m.bind(mainRouter)\n\n/**\n * Create a sub router\n * @returns {function} the method of a new Router object\n */\nroute.create = function() {\n  var newSubRouter = new Router()\n  // stop only this sub-router\n  newSubRouter.m.stop = newSubRouter.s.bind(newSubRouter)\n  // return sub-router's main method\n  return newSubRouter.m.bind(newSubRouter)\n}\n\n/**\n * Set the base of url\n * @param {(str|RegExp)} arg - a new base or '#' or '#!'\n */\nroute.base = function(arg) {\n  base = arg || '#'\n  current = getPathFromBase() // recalculate current path\n}\n\n/** Exec routing right now **/\nroute.exec = function() {\n  emit(true)\n}\n\n/**\n * Replace the default router to yours\n * @param {function} fn - your parser function\n * @param {function} fn2 - your secondParser function\n */\nroute.parser = function(fn, fn2) {\n  if (!fn && !fn2) {\n    // reset parser for testing...\n    parser = DEFAULT_PARSER\n    secondParser = DEFAULT_SECOND_PARSER\n  }\n  if (fn) parser = fn\n  if (fn2) secondParser = fn2\n}\n\n/**\n * Helper function to get url query as an object\n * @returns {object} parsed query\n */\nroute.query = function() {\n  var q = {}\n  loc.href[REPLACE](/[?&](.+?)=([^&]*)/g, function(_, k, v) { q[k] = v })\n  return q\n}\n\n/** Stop routing **/\nroute.stop = function () {\n  if (started) {\n    win[REMOVE_EVENT_LISTENER](POPSTATE, emit)\n    doc[REMOVE_EVENT_LISTENER](clickEvent, click)\n    central[TRIGGER]('stop')\n    started = false\n  }\n}\n\n/** Start routing **/\nroute.start = function () {\n  if (!started) {\n    win[ADD_EVENT_LISTENER](POPSTATE, emit)\n    doc[ADD_EVENT_LISTENER](clickEvent, click)\n    started = true\n  }\n}\n\n/** Prepare the router **/\nroute.base()\nroute.parser()\n\nriot.route = route\n})(riot)\n/* istanbul ignore next */\n\n/**\n * The riot template engine\n * @version 2.3.0\n */\n\n/**\n * @module brackets\n *\n * `brackets         `  Returns a string or regex based on its parameter:\n *                      With a number returns the current left (0) or right (1) brackets.\n *                      With a regex, returns the original regex if the current brackets\n *                      are the default, or a new one with the default brackets replaced\n *                      by the current custom brackets.\n *                      WARNING: recreated regexes discards the `/i` and `/m` flags.\n * `brackets.settings`  This object mirrors the `riot.settings` object, you can assign this\n *                      if riot is not in context.\n * `brackets.set     `  The recommended option to change the current tiot brackets, check\n *                      its parameter and reconfigures the internal state immediately.\n */\n\nvar brackets = (function (UNDEF) {\n\n  var\n    REGLOB  = 'g',\n\n    MLCOMMS = /\\/\\*[^*]*\\*+(?:[^*\\/][^*]*\\*+)*\\//g,\n    STRINGS = /\"[^\"\\\\]*(?:\\\\[\\S\\s][^\"\\\\]*)*\"|'[^'\\\\]*(?:\\\\[\\S\\s][^'\\\\]*)*'/g,\n\n    S_QBSRC = STRINGS.source + '|' +\n      /(?:[$\\w\\)\\]]|\\+\\+|--)\\s*(\\/)(?![*\\/])/.source + '|' +\n      /\\/(?=[^*\\/])[^[\\/\\\\]*(?:(?:\\[(?:\\\\.|[^\\]\\\\]*)*\\]|\\\\.)[^[\\/\\\\]*)*?(\\/)[gim]*/.source,\n\n    DEFAULT = '{ }',\n\n    FINDBRACES = {\n      '(': _regExp('([()])|'   + S_QBSRC, REGLOB),\n      '[': _regExp('([[\\\\]])|' + S_QBSRC, REGLOB),\n      '{': _regExp('([{}])|'   + S_QBSRC, REGLOB)\n    }\n\n  var\n    cachedBrackets = UNDEF,\n    _regex,\n    _pairs = []\n\n  function _regExp(source, flags) { return new RegExp(source, flags) }\n\n  function _loopback(re) { return re }\n\n  function _rewrite(re) {\n    return new RegExp(\n      re.source.replace(/{/g, _pairs[2]).replace(/}/g, _pairs[3]), re.global ? REGLOB : ''\n    )\n  }\n\n  function _reset(pair) {\n    pair = pair || DEFAULT\n\n    if (pair !== _pairs[8]) {\n      var bp = pair.split(' ')\n\n      if (pair === DEFAULT) {\n        _pairs = bp.concat(bp)\n        _regex = _loopback\n      }\n      else {\n        if (bp.length !== 2 || /[\\x00-\\x1F<>a-zA-Z0-9'\",;\\\\]/.test(pair)) {\n          throw new Error('Unsupported brackets \"' + pair + '\"')\n        }\n        _pairs = bp.concat(pair.replace(/(?=[[\\]()*+?.^$|])/g, '\\\\').split(' '))\n        _regex = _rewrite\n      }\n      _pairs[4] = _regex(_pairs[1].length > 1 ? /(?:^|[^\\\\]){[\\S\\s]*?}/ : /(?:^|[^\\\\]){[^}]*}/)\n      _pairs[5] = _regex(/\\\\({|})/g)\n      _pairs[6] = _regex(/(\\\\?)({)/g)\n      _pairs[7] = _regExp('(\\\\\\\\?)(?:([[({])|(' + _pairs[3] + '))|' + S_QBSRC, REGLOB)\n      _pairs[9] = _regExp(/^\\s*{\\^?\\s*([$\\w]+)(?:\\s*,\\s*(\\S+))?\\s+in\\s+(\\S+)\\s*}/)\n      _pairs[8] = pair\n    }\n    _brackets.settings.brackets = cachedBrackets = pair\n  }\n\n  function _set(pair) {\n    if (cachedBrackets !== pair) {\n      _reset(pair)\n    }\n  }\n\n  function _brackets(reOrIdx) {\n    _set(_brackets.settings.brackets)\n    return reOrIdx instanceof RegExp ? _regex(reOrIdx) : _pairs[reOrIdx]\n  }\n\n  _brackets.split = function split(str, tmpl) {\n\n    var\n      parts = [],\n      match,\n      isexpr,\n      start,\n      pos,\n      re = _brackets(6)\n\n    isexpr = start = re.lastIndex = 0\n\n    while (match = re.exec(str)) {\n\n      pos = match.index\n\n      if (isexpr) {\n\n        if (match[2]) {\n          re.lastIndex = skipBraces(match[2], re.lastIndex)\n          continue\n        }\n\n        if (!match[3])\n          continue\n      }\n\n      if (!match[1]) {\n        unescapeStr(str.slice(start, pos))\n        start = re.lastIndex\n        re = _pairs[6 + (isexpr ^= 1)]\n        re.lastIndex = start\n      }\n    }\n\n    if (str && start < str.length) {\n      unescapeStr(str.slice(start))\n    }\n\n    return parts\n\n    function unescapeStr(str) {\n      if (tmpl || isexpr)\n        parts.push(str && str.replace(_pairs[5], '$1'))\n      else\n        parts.push(str)\n    }\n\n    function skipBraces(ch, pos) {\n      var\n        match,\n        recch = FINDBRACES[ch],\n        level = 1\n      recch.lastIndex = pos\n\n      while (match = recch.exec(str)) {\n        if (match[1] &&\n          !(match[1] === ch ? ++level : --level)) break\n      }\n      return match ? recch.lastIndex : str.length\n    }\n  }\n\n  _brackets.hasExpr = function hasExpr(str) {\n    return _brackets(4).test(str)\n  }\n\n  _brackets.loopKeys = function loopKeys(expr) {\n    var m = expr.match(_brackets(9))\n    return m ?\n      { key: m[1], pos: m[2], val: _pairs[0] + m[3] + _pairs[1] } : { val: expr.trim() }\n  }\n\n  _brackets.array = function array(pair) {\n    if (pair != null) _reset(pair)\n    return _pairs\n  }\n\n  /* istanbul ignore next: in the node version riot is not in the scope */\n  _brackets.settings = typeof riot !== 'undefined' && riot.settings || {}\n  _brackets.set = _set\n\n  _brackets.R_STRINGS = STRINGS\n  _brackets.R_MLCOMMS = MLCOMMS\n  _brackets.S_QBLOCKS = S_QBSRC\n\n  _reset(_brackets.settings.brackets)\n\n  return _brackets\n\n})()\n\n/**\n * @module tmpl\n *\n * tmpl          - Root function, returns the template value, render with data\n * tmpl.hasExpr  - Test the existence of a expression inside a string\n * tmpl.loopKeys - Get the keys for an 'each' loop (used by `_each`)\n */\n\nvar tmpl = (function () {\n\n  var\n    FALSE  = !1,\n    _cache = {}\n\n  function _tmpl(str, data) {\n    if (!str) return str\n\n    return (_cache[str] || (_cache[str] = _create(str))).call(data, _logErr)\n  }\n\n  _tmpl.hasExpr = brackets.hasExpr\n\n  _tmpl.loopKeys = brackets.loopKeys\n\n  _tmpl.errorHandler = FALSE\n\n  function _logErr(err, ctx) {\n\n    if (_tmpl.errorHandler) {\n\n      err.riotData = {\n        tagName: ctx && ctx.root && ctx.root.tagName,\n        _riot_id: ctx && ctx._riot_id  //eslint-disable-line camelcase\n      }\n      _tmpl.errorHandler(err)\n    }\n  }\n\n  function _create(str) {\n\n    var expr = _getTmpl(str)\n    if (expr.slice(0, 11) !== \"try{return \") expr = 'return ' + expr\n\n    return new Function('E', expr + ';')  // eslint-disable-line indent\n  }\n\n  var\n    RE_QBLOCK = new RegExp(brackets.S_QBLOCKS, 'g'),\n    RE_QBMARK = /\\x01(\\d+)~/g\n\n  function _getTmpl(str) {\n    var\n      qstr = [],\n      expr,\n      parts = brackets.split(str, 1)\n\n    if (parts.length > 2 || parts[0]) {\n      var i, j, list = []\n\n      for (i = j = 0; i < parts.length; ++i) {\n\n        expr = parts[i]\n\n        if (expr && (expr = i & 1 ?\n\n              _parseExpr(expr, 1, qstr) :\n\n              '\"' + expr\n                .replace(/\\\\/g, '\\\\\\\\')\n                .replace(/\\r\\n?|\\n/g, '\\\\n')\n                .replace(/\"/g, '\\\\\"') +\n              '\"'\n\n          )) list[j++] = expr\n\n      }\n\n      expr = j < 2 ? list[0] :\n             '[' + list.join(',') + '].join(\"\")'\n    }\n    else {\n\n      expr = _parseExpr(parts[1], 0, qstr)\n    }\n\n    if (qstr[0])\n      expr = expr.replace(RE_QBMARK, function (_, pos) {\n        return qstr[pos]\n          .replace(/\\r/g, '\\\\r')\n          .replace(/\\n/g, '\\\\n')\n      })\n\n    return expr\n  }\n\n  var\n    CS_IDENT = /^(?:(-?[_A-Za-z\\xA0-\\xFF][-\\w\\xA0-\\xFF]*)|\\x01(\\d+)~):/,\n    RE_BRACE = /,|([[{(])|$/g\n\n  function _parseExpr(expr, asText, qstr) {\n\n    expr = expr\n          .replace(RE_QBLOCK, function (s, div) {\n            return s.length > 2 && !div ? '\\x01' + (qstr.push(s) - 1) + '~' : s\n          })\n          .replace(/\\s+/g, ' ').trim()\n          .replace(/\\ ?([[\\({},?\\.:])\\ ?/g, '$1')\n\n    if (expr) {\n      var\n        list = [],\n        cnt = 0,\n        match\n\n      while (expr &&\n            (match = expr.match(CS_IDENT)) &&\n            !match.index\n        ) {\n        var\n          key,\n          jsb,\n          re = /,|([[{(])|$/g\n\n        expr = RegExp.rightContext\n        key  = match[2] ? qstr[match[2]].slice(1, -1).trim().replace(/\\s+/g, ' ') : match[1]\n\n        while (jsb = (match = re.exec(expr))[1]) skipBraces(jsb, re)\n\n        jsb  = expr.slice(0, match.index)\n        expr = RegExp.rightContext\n\n        list[cnt++] = _wrapExpr(jsb, 1, key)\n      }\n\n      expr = !cnt ? _wrapExpr(expr, asText) :\n          cnt > 1 ? '[' + list.join(',') + '].join(\" \").trim()' : list[0]\n    }\n    return expr\n\n    function skipBraces(jsb, re) {\n      var\n        match,\n        lv = 1,\n        ir = jsb === '(' ? /[()]/g : jsb === '[' ? /[[\\]]/g : /[{}]/g\n\n      ir.lastIndex = re.lastIndex\n      while (match = ir.exec(expr)) {\n        if (match[0] === jsb) ++lv\n        else if (!--lv) break\n      }\n      re.lastIndex = lv ? expr.length : ir.lastIndex\n    }\n  }\n\n  // istanbul ignore next: not both\n  var JS_CONTEXT = '\"in this?this:' + (typeof window !== 'object' ? 'global' : 'window') + ').'\n  var JS_VARNAME = /[,{][$\\w]+:|(^ *|[^$\\w\\.])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\\w]))([$_A-Za-z][$\\w]*)/g\n\n  function _wrapExpr(expr, asText, key) {\n    var tb = FALSE\n\n    expr = expr.replace(JS_VARNAME, function (match, p, mvar, pos, s) {\n      if (mvar) {\n        pos = tb ? 0 : pos + match.length\n\n        if (mvar !== 'this' && mvar !== 'global' && mvar !== 'window') {\n          match = p + '(\"' + mvar + JS_CONTEXT + mvar\n          if (pos) tb = (s = s[pos]) === '.' || s === '(' || s === '['\n        }\n        else if (pos)\n          tb = !/^(?=(\\.[$\\w]+))\\1(?:[^.[(]|$)/.test(s.slice(pos))\n      }\n      return match\n    })\n\n    if (tb) {\n      expr = \"try{return \" + expr + '}catch(e){E(e,this)}'\n    }\n\n    if (key) {\n\n      expr = (tb ?\n          'function(){' + expr + '}.call(this)' : '(' + expr + ')'\n        ) + '?\"' + key + '\":\"\"'\n    }\n    else if (asText) {\n\n      expr = 'function(v){' + (tb ?\n          expr.replace('return ', 'v=') : 'v=(' + expr + ')'\n        ) + ';return v||v===0?v:\"\"}.call(this)'\n    }\n\n    return expr\n  }\n\n  // istanbul ignore next: compatibility fix for beta versions\n  _tmpl.parse = function (s) { return s }\n\n  return _tmpl\n\n})()\n\n\n/*\n  lib/browser/tag/mkdom.js\n\n  Includes hacks needed for the Internet Explorer version 9 and bellow\n\n*/\n// http://kangax.github.io/compat-table/es5/#ie8\n// http://codeplanet.io/dropping-ie8/\n\nvar mkdom = (function (checkIE) {\n\n  var rootEls = {\n      'tr': 'tbody',\n      'th': 'tr',\n      'td': 'tr',\n      'tbody': 'table',\n      'col': 'colgroup'\n    },\n    GENERIC = 'div'\n\n  checkIE = checkIE && checkIE < 10\n\n  // creates any dom element in a div, table, or colgroup container\n  function _mkdom(html) {\n\n    var match = html && html.match(/^\\s*<([-\\w]+)/),\n      tagName = match && match[1].toLowerCase(),\n      rootTag = rootEls[tagName] || GENERIC,\n      el = mkEl(rootTag)\n\n    el.stub = true\n\n    /* istanbul ignore next */\n    if (checkIE && tagName && (match = tagName.match(SPECIAL_TAGS_REGEX)))\n      ie9elem(el, html, tagName, !!match[1])\n    else\n      el.innerHTML = html\n\n    return el\n  }\n\n  // creates tr, th, td, option, optgroup element for IE8-9\n  /* istanbul ignore next */\n  function ie9elem(el, html, tagName, select) {\n\n    var div = mkEl(GENERIC),\n      tag = select ? 'select>' : 'table>',\n      child\n\n    div.innerHTML = '<' + tag + html + '</' + tag\n\n    child = $(tagName, div)\n    if (child)\n      el.appendChild(child)\n\n  }\n  // end ie9elem()\n\n  return _mkdom\n\n})(IE_VERSION)\n\n/**\n * Convert the item looped into an object used to extend the child tag properties\n * @param   { Object } expr - object containing the keys used to extend the children tags\n * @param   { * } key - value to assign to the new object returned\n * @param   { * } val - value containing the position of the item in the array\n * @returns { Object } - new object containing the values of the original item\n *\n * The variables 'key' and 'val' are arbitrary.\n * They depend on the collection type looped (Array, Object)\n * and on the expression used on the each tag\n *\n */\nfunction mkitem(expr, key, val) {\n  var item = {}\n  item[expr.key] = key\n  if (expr.pos) item[expr.pos] = val\n  return item\n}\n\n/**\n * Unmount the redundant tags\n * @param   { Array } items - array containing the current items to loop\n * @param   { Array } tags - array containing all the children tags\n */\nfunction unmountRedundant(items, tags) {\n\n  var i = tags.length,\n    j = items.length\n\n  while (i > j) {\n    var t = tags[--i]\n    tags.splice(i, 1)\n    t.unmount()\n  }\n}\n\n/**\n * Move the nested custom tags in non custom loop tags\n * @param   { Object } child - non custom loop tag\n * @param   { Number } i - current position of the loop tag\n */\nfunction moveNestedTags(child, i) {\n  Object.keys(child.tags).forEach(function(tagName) {\n    var tag = child.tags[tagName]\n    if (isArray(tag))\n      each(tag, function (t) {\n        moveChildTag(t, tagName, i)\n      })\n    else\n      moveChildTag(tag, tagName, i)\n  })\n}\n\n/**\n * Adds the elements for a virtual tag\n * @param { Tag } tag - the tag whose root's children will be inserted or appended\n * @param { Node } src - the node that will do the inserting or appending\n * @param { Tag } target - only if inserting, insert before this tag's first child\n */\nfunction addVirtual(tag, src, target) {\n  var el = tag._root\n  tag._virts = []\n  while (el) {\n    var sib = el.nextSibling\n    if (target)\n      src.insertBefore(el, target._root)\n    else\n      src.appendChild(el)\n\n    tag._virts.push(el) // hold for unmounting\n    el = sib\n  }\n}\n\n/**\n * Move virtual tag and all child nodes\n * @param { Tag } tag - first child reference used to start move\n * @param { Node } src  - the node that will do the inserting\n * @param { Tag } target - insert before this tag's first child\n * @param { Number } len - how many child nodes to move\n */\nfunction moveVirtual(tag, src, target, len) {\n  var el = tag._root\n  for (var i = 0; i < len; i++) {\n    var sib = el.nextSibling\n    src.insertBefore(el, target._root)\n    el = sib\n  }\n}\n\n\n/**\n * Manage tags having the 'each'\n * @param   { Object } dom - DOM node we need to loop\n * @param   { Tag } parent - parent tag instance where the dom node is contained\n * @param   { String } expr - string contained in the 'each' attribute\n */\nfunction _each(dom, parent, expr) {\n\n  // remove the each property from the original tag\n  remAttr(dom, 'each')\n\n  var mustReorder = typeof getAttr(dom, 'no-reorder') !== T_STRING || remAttr(dom, 'no-reorder'),\n    tagName = getTagName(dom),\n    impl = __tagImpl[tagName] || { tmpl: dom.outerHTML },\n    useRoot = SPECIAL_TAGS_REGEX.test(tagName),\n    root = dom.parentNode,\n    isSpecialTag = SPECIAL_TAGS_REGEX.test(tagName),\n    ref = document.createTextNode(''),\n    child = getTag(dom),\n    tags = [],\n    oldItems = [],\n    checksum,\n    isVirtual = dom.tagName == 'VIRTUAL'\n\n  // parse the each expression\n  expr = tmpl.loopKeys(expr)\n\n  // insert a marked where the loop tags will be injected\n  root.insertBefore(ref, dom)\n\n  // clean template code\n  parent.one('before-mount', function () {\n\n    // remove the original DOM node\n    dom.parentNode.removeChild(dom)\n    if (root.stub) root = parent.root\n\n  }).on('update', function () {\n    // get the new items collection\n    var items = tmpl(expr.val, parent),\n      // create a fragment to hold the new DOM nodes to inject in the parent tag\n      frag = document.createDocumentFragment()\n\n    // object loop. any changes cause full redraw\n    if (!isArray(items)) {\n      checksum = items ? JSON.stringify(items) : ''\n      items = !items ? [] :\n        Object.keys(items).map(function (key) {\n          return mkitem(expr, key, items[key])\n        })\n    }\n\n    // loop all the new items\n    each(items, function(item, i) {\n      // reorder only if the items are objects\n      var _mustReorder = mustReorder && item instanceof Object,\n        oldPos = oldItems.indexOf(item),\n        pos = ~oldPos && _mustReorder ? oldPos : i,\n        // does a tag exist in this position?\n        tag = tags[pos]\n\n      item = !checksum && expr.key ? mkitem(expr, item, i) : item\n\n      // new tag\n      if (\n        !_mustReorder && !tag // with no-reorder we just update the old tags\n        ||\n        _mustReorder && !~oldPos || !tag // by default we always try to reorder the DOM elements\n      ) {\n\n        tag = new Tag(impl, {\n          parent: parent,\n          isLoop: true,\n          hasImpl: !!__tagImpl[tagName],\n          root: useRoot ? root : dom.cloneNode(),\n          item: item\n        }, dom.innerHTML)\n\n        tag.mount()\n        if (isVirtual) tag._root = tag.root.firstChild // save reference for further moves or inserts\n        // this tag must be appended\n        if (i == tags.length) {\n          if (isVirtual)\n            addVirtual(tag, frag)\n          else frag.appendChild(tag.root)\n        }\n        // this tag must be insert\n        else {\n          if (isVirtual)\n            addVirtual(tag, root, tags[i])\n          else root.insertBefore(tag.root, tags[i].root)\n          oldItems.splice(i, 0, item)\n        }\n\n        tags.splice(i, 0, tag)\n        pos = i // handled here so no move\n      } else tag.update(item)\n\n      // reorder the tag if it's not located in its previous position\n      if (pos !== i && _mustReorder) {\n        // update the DOM\n        if (isVirtual)\n          moveVirtual(tag, root, tags[i], dom.childNodes.length)\n        else root.insertBefore(tag.root, tags[i].root)\n        // update the position attribute if it exists\n        if (expr.pos)\n          tag[expr.pos] = i\n        // move the old tag instance\n        tags.splice(i, 0, tags.splice(pos, 1)[0])\n        // move the old item\n        oldItems.splice(i, 0, oldItems.splice(pos, 1)[0])\n        // if the loop tags are not custom\n        // we need to move all their custom tags into the right position\n        if (!child) moveNestedTags(tag, i)\n      }\n\n      // cache the original item to use it in the events bound to this node\n      // and its children\n      tag._item = item\n      // cache the real parent tag internally\n      defineProperty(tag, '_parent', parent)\n\n    })\n\n    // remove the redundant tags\n    unmountRedundant(items, tags)\n\n    // insert the new nodes\n    if (isSpecialTag) root.appendChild(frag)\n    else root.insertBefore(frag, ref)\n\n    // set the 'tags' property of the parent tag\n    // if child is 'undefined' it means that we don't need to set this property\n    // for example:\n    // we don't need store the `myTag.tags['div']` property if we are looping a div tag\n    // but we need to track the `myTag.tags['child']` property looping a custom child node named `child`\n    if (child) parent.tags[tagName] = tags\n\n    // clone the items array\n    oldItems = items.slice()\n\n  })\n\n}\n\n\nfunction parseNamedElements(root, tag, childTags, forceParsingNamed) {\n\n  walk(root, function(dom) {\n    if (dom.nodeType == 1) {\n      dom.isLoop = dom.isLoop || (dom.parentNode && dom.parentNode.isLoop || getAttr(dom, 'each')) ? 1 : 0\n\n      // custom child tag\n      if (childTags) {\n        var child = getTag(dom)\n\n        if (child && !dom.isLoop)\n          childTags.push(initChildTag(child, {root: dom, parent: tag}, dom.innerHTML, tag))\n      }\n\n      if (!dom.isLoop || forceParsingNamed)\n        setNamed(dom, tag, [])\n    }\n\n  })\n\n}\n\nfunction parseExpressions(root, tag, expressions) {\n\n  function addExpr(dom, val, extra) {\n    if (tmpl.hasExpr(val)) {\n      var expr = { dom: dom, expr: val }\n      expressions.push(extend(expr, extra))\n    }\n  }\n\n  walk(root, function(dom) {\n    var type = dom.nodeType\n\n    // text node\n    if (type == 3 && dom.parentNode.tagName != 'STYLE') addExpr(dom, dom.nodeValue)\n    if (type != 1) return\n\n    /* element */\n\n    // loop\n    var attr = getAttr(dom, 'each')\n\n    if (attr) { _each(dom, tag, attr); return false }\n\n    // attribute expressions\n    each(dom.attributes, function(attr) {\n      var name = attr.name,\n        bool = name.split('__')[1]\n\n      addExpr(dom, attr.value, { attr: bool || name, bool: bool })\n      if (bool) { remAttr(dom, name); return false }\n\n    })\n\n    // skip custom tags\n    if (getTag(dom)) return false\n\n  })\n\n}\nfunction Tag(impl, conf, innerHTML) {\n\n  var self = riot.observable(this),\n    opts = inherit(conf.opts) || {},\n    dom = mkdom(impl.tmpl),\n    parent = conf.parent,\n    isLoop = conf.isLoop,\n    hasImpl = conf.hasImpl,\n    item = cleanUpData(conf.item),\n    expressions = [],\n    childTags = [],\n    root = conf.root,\n    fn = impl.fn,\n    tagName = root.tagName.toLowerCase(),\n    attr = {},\n    propsInSyncWithParent = []\n\n  if (fn && root._tag) root._tag.unmount(true)\n\n  // not yet mounted\n  this.isMounted = false\n  root.isLoop = isLoop\n\n  // keep a reference to the tag just created\n  // so we will be able to mount this tag multiple times\n  root._tag = this\n\n  // create a unique id to this tag\n  // it could be handy to use it also to improve the virtual dom rendering speed\n  defineProperty(this, '_riot_id', ++__uid) // base 1 allows test !t._riot_id\n\n  extend(this, { parent: parent, root: root, opts: opts, tags: {} }, item)\n\n  // grab attributes\n  each(root.attributes, function(el) {\n    var val = el.value\n    // remember attributes with expressions only\n    if (tmpl.hasExpr(val)) attr[el.name] = val\n  })\n\n  if (dom.innerHTML && !/^(select|optgroup|table|tbody|tr|col(?:group)?)$/.test(tagName))\n    // replace all the yield tags with the tag inner html\n    dom.innerHTML = replaceYield(dom.innerHTML, innerHTML)\n\n  // options\n  function updateOpts() {\n    var ctx = hasImpl && isLoop ? self : parent || self\n\n    // update opts from current DOM attributes\n    each(root.attributes, function(el) {\n      opts[toCamel(el.name)] = tmpl(el.value, ctx)\n    })\n    // recover those with expressions\n    each(Object.keys(attr), function(name) {\n      opts[toCamel(name)] = tmpl(attr[name], ctx)\n    })\n  }\n\n  function normalizeData(data) {\n    for (var key in item) {\n      if (typeof self[key] !== T_UNDEF && isWritable(self, key))\n        self[key] = data[key]\n    }\n  }\n\n  function inheritFromParent () {\n    if (!self.parent || !isLoop) return\n    each(Object.keys(self.parent), function(k) {\n      // some properties must be always in sync with the parent tag\n      var mustSync = !contains(RESERVED_WORDS_BLACKLIST, k) && contains(propsInSyncWithParent, k)\n      if (typeof self[k] === T_UNDEF || mustSync) {\n        // track the property to keep in sync\n        // so we can keep it updated\n        if (!mustSync) propsInSyncWithParent.push(k)\n        self[k] = self.parent[k]\n      }\n    })\n  }\n\n  defineProperty(this, 'update', function(data) {\n\n    // make sure the data passed will not override\n    // the component core methods\n    data = cleanUpData(data)\n    // inherit properties from the parent\n    inheritFromParent()\n    // normalize the tag properties in case an item object was initially passed\n    if (data && typeof item === T_OBJECT) {\n      normalizeData(data)\n      item = data\n    }\n    extend(self, data)\n    updateOpts()\n    self.trigger('update', data)\n    update(expressions, self)\n    self.trigger('updated')\n    return this\n  })\n\n  defineProperty(this, 'mixin', function() {\n    each(arguments, function(mix) {\n      mix = typeof mix === T_STRING ? riot.mixin(mix) : mix\n      each(Object.keys(mix), function(key) {\n        // bind methods to self\n        if (key != 'init')\n          self[key] = isFunction(mix[key]) ? mix[key].bind(self) : mix[key]\n      })\n      // init method will be called automatically\n      if (mix.init) mix.init.bind(self)()\n    })\n    return this\n  })\n\n  defineProperty(this, 'mount', function() {\n\n    updateOpts()\n\n    // initialiation\n    if (fn) fn.call(self, opts)\n\n    // parse layout after init. fn may calculate args for nested custom tags\n    parseExpressions(dom, self, expressions)\n\n    // mount the child tags\n    toggle(true)\n\n    // update the root adding custom attributes coming from the compiler\n    // it fixes also #1087\n    if (impl.attrs || hasImpl) {\n      walkAttributes(impl.attrs, function (k, v) { setAttr(root, k, v) })\n      parseExpressions(self.root, self, expressions)\n    }\n\n    if (!self.parent || isLoop) self.update(item)\n\n    // internal use only, fixes #403\n    self.trigger('before-mount')\n\n    if (isLoop && !hasImpl) {\n      // update the root attribute for the looped elements\n      self.root = root = dom.firstChild\n\n    } else {\n      while (dom.firstChild) root.appendChild(dom.firstChild)\n      if (root.stub) self.root = root = parent.root\n    }\n\n    // parse the named dom nodes in the looped child\n    // adding them to the parent as well\n    if (isLoop)\n      parseNamedElements(self.root, self.parent, null, true)\n\n    // if it's not a child tag we can trigger its mount event\n    if (!self.parent || self.parent.isMounted) {\n      self.isMounted = true\n      self.trigger('mount')\n    }\n    // otherwise we need to wait that the parent event gets triggered\n    else self.parent.one('mount', function() {\n      // avoid to trigger the `mount` event for the tags\n      // not visible included in an if statement\n      if (!isInStub(self.root)) {\n        self.parent.isMounted = self.isMounted = true\n        self.trigger('mount')\n      }\n    })\n  })\n\n\n  defineProperty(this, 'unmount', function(keepRootTag) {\n    var el = root,\n      p = el.parentNode,\n      ptag\n\n    self.trigger('before-unmount')\n\n    // remove this tag instance from the global virtualDom variable\n    __virtualDom.splice(__virtualDom.indexOf(self), 1)\n\n    if (this._virts) {\n      each(this._virts, function(v) {\n        v.parentNode.removeChild(v)\n      })\n    }\n\n    if (p) {\n\n      if (parent) {\n        ptag = getImmediateCustomParentTag(parent)\n        // remove this tag from the parent tags object\n        // if there are multiple nested tags with same name..\n        // remove this element form the array\n        if (isArray(ptag.tags[tagName]))\n          each(ptag.tags[tagName], function(tag, i) {\n            if (tag._riot_id == self._riot_id)\n              ptag.tags[tagName].splice(i, 1)\n          })\n        else\n          // otherwise just delete the tag instance\n          ptag.tags[tagName] = undefined\n      }\n\n      else\n        while (el.firstChild) el.removeChild(el.firstChild)\n\n      if (!keepRootTag)\n        p.removeChild(el)\n      else\n        // the riot-tag attribute isn't needed anymore, remove it\n        remAttr(p, 'riot-tag')\n    }\n\n\n    self.trigger('unmount')\n    toggle()\n    self.off('*')\n    self.isMounted = false\n    // somehow ie8 does not like `delete root._tag`\n    root._tag = null\n\n  })\n\n  function toggle(isMount) {\n\n    // mount/unmount children\n    each(childTags, function(child) { child[isMount ? 'mount' : 'unmount']() })\n\n    // listen/unlisten parent (events flow one way from parent to children)\n    if (parent) {\n      var evt = isMount ? 'on' : 'off'\n\n      // the loop tags will be always in sync with the parent automatically\n      if (isLoop)\n        parent[evt]('unmount', self.unmount)\n      else\n        parent[evt]('update', self.update)[evt]('unmount', self.unmount)\n    }\n  }\n\n  // named elements available for fn\n  parseNamedElements(dom, this, childTags)\n\n}\n/**\n * Attach an event to a DOM node\n * @param { String } name - event name\n * @param { Function } handler - event callback\n * @param { Object } dom - dom node\n * @param { Tag } tag - tag instance\n */\nfunction setEventHandler(name, handler, dom, tag) {\n\n  dom[name] = function(e) {\n\n    var ptag = tag._parent,\n      item = tag._item,\n      el\n\n    if (!item)\n      while (ptag && !item) {\n        item = ptag._item\n        ptag = ptag._parent\n      }\n\n    // cross browser event fix\n    e = e || window.event\n\n    // override the event properties\n    if (isWritable(e, 'currentTarget')) e.currentTarget = dom\n    if (isWritable(e, 'target')) e.target = e.srcElement\n    if (isWritable(e, 'which')) e.which = e.charCode || e.keyCode\n\n    e.item = item\n\n    // prevent default behaviour (by default)\n    if (handler.call(tag, e) !== true && !/radio|check/.test(dom.type)) {\n      if (e.preventDefault) e.preventDefault()\n      e.returnValue = false\n    }\n\n    if (!e.preventUpdate) {\n      el = item ? getImmediateCustomParentTag(ptag) : tag\n      el.update()\n    }\n\n  }\n\n}\n\n\n/**\n * Insert a DOM node replacing another one (used by if- attribute)\n * @param   { Object } root - parent node\n * @param   { Object } node - node replaced\n * @param   { Object } before - node added\n */\nfunction insertTo(root, node, before) {\n  if (root) {\n    root.insertBefore(before, node)\n    root.removeChild(node)\n  }\n}\n\n/**\n * Update the expressions in a Tag instance\n * @param   { Array } expressions - expression that must be re evaluated\n * @param   { Tag } tag - tag instance\n */\nfunction update(expressions, tag) {\n\n  each(expressions, function(expr, i) {\n\n    var dom = expr.dom,\n      attrName = expr.attr,\n      value = tmpl(expr.expr, tag),\n      parent = expr.dom.parentNode\n\n    if (expr.bool)\n      value = value ? attrName : false\n    else if (value == null)\n      value = ''\n\n    // leave out riot- prefixes from strings inside textarea\n    // fix #815: any value -> string\n    if (parent && parent.tagName == 'TEXTAREA') value = ('' + value).replace(/riot-/g, '')\n\n    // no change\n    if (expr.value === value) return\n    expr.value = value\n\n    // text node\n    if (!attrName) {\n      dom.nodeValue = '' + value    // #815 related\n      return\n    }\n\n    // remove original attribute\n    remAttr(dom, attrName)\n    // event handler\n    if (isFunction(value)) {\n      setEventHandler(attrName, value, dom, tag)\n\n    // if- conditional\n    } else if (attrName == 'if') {\n      var stub = expr.stub,\n        add = function() { insertTo(stub.parentNode, stub, dom) },\n        remove = function() { insertTo(dom.parentNode, dom, stub) }\n\n      // add to DOM\n      if (value) {\n        if (stub) {\n          add()\n          dom.inStub = false\n          // avoid to trigger the mount event if the tags is not visible yet\n          // maybe we can optimize this avoiding to mount the tag at all\n          if (!isInStub(dom)) {\n            walk(dom, function(el) {\n              if (el._tag && !el._tag.isMounted) el._tag.isMounted = !!el._tag.trigger('mount')\n            })\n          }\n        }\n      // remove from DOM\n      } else {\n        stub = expr.stub = stub || document.createTextNode('')\n        // if the parentNode is defined we can easily replace the tag\n        if (dom.parentNode)\n          remove()\n        // otherwise we need to wait the updated event\n        else (tag.parent || tag).one('updated', remove)\n\n        dom.inStub = true\n      }\n    // show / hide\n    } else if (/^(show|hide)$/.test(attrName)) {\n      if (attrName == 'hide') value = !value\n      dom.style.display = value ? '' : 'none'\n\n    // field value\n    } else if (attrName == 'value') {\n      dom.value = value\n\n    // <img src=\"{ expr }\">\n    } else if (startsWith(attrName, RIOT_PREFIX) && attrName != RIOT_TAG) {\n      if (value)\n        setAttr(dom, attrName.slice(RIOT_PREFIX.length), value)\n\n    } else {\n      if (expr.bool) {\n        dom[attrName] = value\n        if (!value) return\n      }\n\n      if (typeof value !== T_OBJECT) setAttr(dom, attrName, value)\n\n    }\n\n  })\n\n}\n/**\n * Loops an array\n * @param   { Array } els - collection of items\n * @param   {Function} fn - callback function\n * @returns { Array } the array looped\n */\nfunction each(els, fn) {\n  for (var i = 0, len = (els || []).length, el; i < len; i++) {\n    el = els[i]\n    // return false -> remove current item during loop\n    if (el != null && fn(el, i) === false) i--\n  }\n  return els\n}\n\n/**\n * Detect if the argument passed is a function\n * @param   { * } v - whatever you want to pass to this function\n * @returns { Boolean } -\n */\nfunction isFunction(v) {\n  return typeof v === T_FUNCTION || false   // avoid IE problems\n}\n\n/**\n * Remove any DOM attribute from a node\n * @param   { Object } dom - DOM node we want to update\n * @param   { String } name - name of the property we want to remove\n */\nfunction remAttr(dom, name) {\n  dom.removeAttribute(name)\n}\n\n/**\n * Convert a string containing dashes to camle case\n * @param   { String } string - input string\n * @returns { String } my-string -> myString\n */\nfunction toCamel(string) {\n  return string.replace(/(\\-\\w)/g, function(match) {\n    return match.toUpperCase().replace('-', '')\n  })\n}\n\n/**\n * Get the value of any DOM attribute on a node\n * @param   { Object } dom - DOM node we want to parse\n * @param   { String } name - name of the attribute we want to get\n * @returns { String | undefined } name of the node attribute whether it exists\n */\nfunction getAttr(dom, name) {\n  return dom.getAttribute(name)\n}\n\n/**\n * Set any DOM attribute\n * @param { Object } dom - DOM node we want to update\n * @param { String } name - name of the property we want to set\n * @param { String } val - value of the property we want to set\n */\nfunction setAttr(dom, name, val) {\n  dom.setAttribute(name, val)\n}\n\n/**\n * Detect the tag implementation by a DOM node\n * @param   { Object } dom - DOM node we need to parse to get its tag implementation\n * @returns { Object } it returns an object containing the implementation of a custom tag (template and boot function)\n */\nfunction getTag(dom) {\n  return dom.tagName && __tagImpl[getAttr(dom, RIOT_TAG) || dom.tagName.toLowerCase()]\n}\n/**\n * Add a child tag to its parent into the `tags` object\n * @param   { Object } tag - child tag instance\n * @param   { String } tagName - key where the new tag will be stored\n * @param   { Object } parent - tag instance where the new child tag will be included\n */\nfunction addChildTag(tag, tagName, parent) {\n  var cachedTag = parent.tags[tagName]\n\n  // if there are multiple children tags having the same name\n  if (cachedTag) {\n    // if the parent tags property is not yet an array\n    // create it adding the first cached tag\n    if (!isArray(cachedTag))\n      // don't add the same tag twice\n      if (cachedTag !== tag)\n        parent.tags[tagName] = [cachedTag]\n    // add the new nested tag to the array\n    if (!contains(parent.tags[tagName], tag))\n      parent.tags[tagName].push(tag)\n  } else {\n    parent.tags[tagName] = tag\n  }\n}\n\n/**\n * Move the position of a custom tag in its parent tag\n * @param   { Object } tag - child tag instance\n * @param   { String } tagName - key where the tag was stored\n * @param   { Number } newPos - index where the new tag will be stored\n */\nfunction moveChildTag(tag, tagName, newPos) {\n  var parent = tag.parent,\n    tags\n  // no parent no move\n  if (!parent) return\n\n  tags = parent.tags[tagName]\n\n  if (isArray(tags))\n    tags.splice(newPos, 0, tags.splice(tags.indexOf(tag), 1)[0])\n  else addChildTag(tag, tagName, parent)\n}\n\n/**\n * Create a new child tag including it correctly into its parent\n * @param   { Object } child - child tag implementation\n * @param   { Object } opts - tag options containing the DOM node where the tag will be mounted\n * @param   { String } innerHTML - inner html of the child node\n * @param   { Object } parent - instance of the parent tag including the child custom tag\n * @returns { Object } instance of the new child tag just created\n */\nfunction initChildTag(child, opts, innerHTML, parent) {\n  var tag = new Tag(child, opts, innerHTML),\n    tagName = getTagName(opts.root),\n    ptag = getImmediateCustomParentTag(parent)\n  // fix for the parent attribute in the looped elements\n  tag.parent = ptag\n  // store the real parent tag\n  // in some cases this could be different from the custom parent tag\n  // for example in nested loops\n  tag._parent = parent\n\n  // add this tag to the custom parent tag\n  addChildTag(tag, tagName, ptag)\n  // and also to the real parent tag\n  if (ptag !== parent)\n    addChildTag(tag, tagName, parent)\n  // empty the child node once we got its template\n  // to avoid that its children get compiled multiple times\n  opts.root.innerHTML = ''\n\n  return tag\n}\n\n/**\n * Loop backward all the parents tree to detect the first custom parent tag\n * @param   { Object } tag - a Tag instance\n * @returns { Object } the instance of the first custom parent tag found\n */\nfunction getImmediateCustomParentTag(tag) {\n  var ptag = tag\n  while (!getTag(ptag.root)) {\n    if (!ptag.parent) break\n    ptag = ptag.parent\n  }\n  return ptag\n}\n\n/**\n * Helper function to set an immutable property\n * @param   { Object } el - object where the new property will be set\n * @param   { String } key - object key where the new property will be stored\n * @param   { * } value - value of the new property\n* @param   { Object } options - set the propery overriding the default options\n * @returns { Object } - the initial object\n */\nfunction defineProperty(el, key, value, options) {\n  Object.defineProperty(el, key, extend({\n    value: value,\n    enumerable: false,\n    writable: false,\n    configurable: false\n  }, options))\n  return el\n}\n\n/**\n * Get the tag name of any DOM node\n * @param   { Object } dom - DOM node we want to parse\n * @returns { String } name to identify this dom node in riot\n */\nfunction getTagName(dom) {\n  var child = getTag(dom),\n    namedTag = getAttr(dom, 'name'),\n    tagName = namedTag && !tmpl.hasExpr(namedTag) ?\n                namedTag :\n              child ? child.name : dom.tagName.toLowerCase()\n\n  return tagName\n}\n\n/**\n * Extend any object with other properties\n * @param   { Object } src - source object\n * @returns { Object } the resulting extended object\n *\n * var obj = { foo: 'baz' }\n * extend(obj, {bar: 'bar', foo: 'bar'})\n * console.log(obj) => {bar: 'bar', foo: 'bar'}\n *\n */\nfunction extend(src) {\n  var obj, args = arguments\n  for (var i = 1; i < args.length; ++i) {\n    if (obj = args[i]) {\n      for (var key in obj) {\n        // check if this property of the source object could be overridden\n        if (isWritable(src, key))\n          src[key] = obj[key]\n      }\n    }\n  }\n  return src\n}\n\n/**\n * Check whether an array contains an item\n * @param   { Array } arr - target array\n * @param   { * } item - item to test\n * @returns { Boolean } Does 'arr' contain 'item'?\n */\nfunction contains(arr, item) {\n  return ~arr.indexOf(item)\n}\n\n/**\n * Check whether an object is a kind of array\n * @param   { * } a - anything\n * @returns {Boolean} is 'a' an array?\n */\nfunction isArray(a) { return Array.isArray(a) || a instanceof Array }\n\n/**\n * Detect whether a property of an object could be overridden\n * @param   { Object }  obj - source object\n * @param   { String }  key - object property\n * @returns { Boolean } is this property writable?\n */\nfunction isWritable(obj, key) {\n  var props = Object.getOwnPropertyDescriptor(obj, key)\n  return typeof obj[key] === T_UNDEF || props && props.writable\n}\n\n\n/**\n * With this function we avoid that the internal Tag methods get overridden\n * @param   { Object } data - options we want to use to extend the tag instance\n * @returns { Object } clean object without containing the riot internal reserved words\n */\nfunction cleanUpData(data) {\n  if (!(data instanceof Tag) && !(data && typeof data.trigger == T_FUNCTION)) return data\n\n  var o = {}\n  for (var key in data) {\n    if (!contains(RESERVED_WORDS_BLACKLIST, key))\n      o[key] = data[key]\n  }\n  return o\n}\n\n/**\n * Walk down recursively all the children tags starting dom node\n * @param   { Object }   dom - starting node where we will start the recursion\n * @param   { Function } fn - callback to transform the child node just found\n */\nfunction walk(dom, fn) {\n  if (dom) {\n    // stop the recursion\n    if (fn(dom) === false) return\n    else {\n      dom = dom.firstChild\n\n      while (dom) {\n        walk(dom, fn)\n        dom = dom.nextSibling\n      }\n    }\n  }\n}\n\n/**\n * Minimize risk: only zero or one _space_ between attr & value\n * @param   { String }   html - html string we want to parse\n * @param   { Function } fn - callback function to apply on any attribute found\n */\nfunction walkAttributes(html, fn) {\n  var m,\n    re = /([-\\w]+) ?= ?(?:\"([^\"]*)|'([^']*)|({[^}]*}))/g\n\n  while (m = re.exec(html)) {\n    fn(m[1].toLowerCase(), m[2] || m[3] || m[4])\n  }\n}\n\n/**\n * Check whether a DOM node is in stub mode, useful for the riot 'if' directive\n * @param   { Object }  dom - DOM node we want to parse\n * @returns { Boolean } -\n */\nfunction isInStub(dom) {\n  while (dom) {\n    if (dom.inStub) return true\n    dom = dom.parentNode\n  }\n  return false\n}\n\n/**\n * Create a generic DOM node\n * @param   { String } name - name of the DOM node we want to create\n * @returns { Object } DOM node just created\n */\nfunction mkEl(name) {\n  return document.createElement(name)\n}\n\n/**\n * Replace the yield tag from any tag template with the innerHTML of the\n * original tag in the page\n * @param   { String } tmpl - tag implementation template\n * @param   { String } innerHTML - original content of the tag in the DOM\n * @returns { String } tag template updated without the yield tag\n */\nfunction replaceYield(tmpl, innerHTML) {\n  return tmpl.replace(/<(yield)\\/?>(<\\/\\1>)?/gi, innerHTML || '')\n}\n\n/**\n * Shorter and fast way to select multiple nodes in the DOM\n * @param   { String } selector - DOM selector\n * @param   { Object } ctx - DOM node where the targets of our search will is located\n * @returns { Object } dom nodes found\n */\nfunction $$(selector, ctx) {\n  return (ctx || document).querySelectorAll(selector)\n}\n\n/**\n * Shorter and fast way to select a single node in the DOM\n * @param   { String } selector - unique dom selector\n * @param   { Object } ctx - DOM node where the target of our search will is located\n * @returns { Object } dom node found\n */\nfunction $(selector, ctx) {\n  return (ctx || document).querySelector(selector)\n}\n\n/**\n * Simple object prototypal inheritance\n * @param   { Object } parent - parent object\n * @returns { Object } child instance\n */\nfunction inherit(parent) {\n  function Child() {}\n  Child.prototype = parent\n  return new Child()\n}\n\n/**\n * Get the name property needed to identify a DOM node in riot\n * @param   { Object } dom - DOM node we need to parse\n * @returns { String | undefined } give us back a string to identify this dom node\n */\nfunction getNamedKey(dom) {\n  return getAttr(dom, 'id') || getAttr(dom, 'name')\n}\n\n/**\n * Set the named properties of a tag element\n * @param { Object } dom - DOM node we need to parse\n * @param { Object } parent - tag instance where the named dom element will be eventually added\n * @param { Array } keys - list of all the tag instance properties\n */\nfunction setNamed(dom, parent, keys) {\n  // get the key value we want to add to the tag instance\n  var key = getNamedKey(dom),\n    // add the node detected to a tag instance using the named property\n    add = function(value) {\n      // avoid to override the tag properties already set\n      if (contains(keys, key)) return\n      // check whether this value is an array\n      var isArr = isArray(value)\n      // if the key was never set\n      if (!value)\n        // set it once on the tag instance\n        parent[key] = dom\n      // if it was an array and not yet set\n      else if (!isArr || isArr && !contains(value, dom)) {\n        // add the dom node into the array\n        if (isArr)\n          value.push(dom)\n        else\n          parent[key] = [value, dom]\n      }\n    }\n\n  // skip the elements with no named properties\n  if (!key) return\n\n  // check whether this key has been already evaluated\n  if (tmpl.hasExpr(key))\n    // wait the first updated event only once\n    parent.one('updated', function() {\n      key = getNamedKey(dom)\n      add(parent[key])\n    })\n  else\n    add(parent[key])\n\n}\n\n/**\n * Faster String startsWith alternative\n * @param   { String } src - source string\n * @param   { String } str - test string\n * @returns { Boolean } -\n */\nfunction startsWith(src, str) {\n  return src.slice(0, str.length) === str\n}\n\n/**\n * Function needed to inject in runtime the custom tags css\n */\nvar injectStyle = (function() {\n\n  if (!window) return // skip injection on the server\n\n  // create the style node\n  var styleNode = mkEl('style'),\n    placeholder = $('style[type=riot]')\n\n  setAttr(styleNode, 'type', 'text/css')\n\n  // inject the new node into the DOM -- in head\n  if (placeholder) {\n    placeholder.parentNode.replaceChild(styleNode, placeholder)\n    placeholder = null\n  }\n  else document.getElementsByTagName('head')[0].appendChild(styleNode)\n\n  /**\n   * This is the function exported that will be used to update the style tag just created\n   * innerHTML seems slow: http://jsperf.com/riot-insert-style\n   * @param   { String } css [description]\n   */\n  return styleNode.styleSheet ?\n    function (css) { styleNode.styleSheet.cssText += css } :\n    function (css) { styleNode.innerHTML += css }\n\n})()\n\n/**\n * Mount a tag creating new Tag instance\n * @param   { Object } root - dom node where the tag will be mounted\n * @param   { String } tagName - name of the riot tag we want to mount\n * @param   { Object } opts - options to pass to the Tag instance\n * @returns { Tag } a new Tag instance\n */\nfunction mountTo(root, tagName, opts) {\n  var tag = __tagImpl[tagName],\n    // cache the inner HTML to fix #855\n    innerHTML = root._innerHTML = root._innerHTML || root.innerHTML\n\n  // clear the inner html\n  root.innerHTML = ''\n\n  if (tag && root) tag = new Tag(tag, { root: root, opts: opts }, innerHTML)\n\n  if (tag && tag.mount) {\n    tag.mount()\n    // add this tag to the virtualDom variable\n    if (!contains(__virtualDom, tag)) __virtualDom.push(tag)\n  }\n\n  return tag\n}\n/**\n * Riot public api\n */\n\n// share methods for other riot parts, e.g. compiler\nriot.util = { brackets: brackets, tmpl: tmpl }\n\n/**\n * Create a mixin that could be globally shared across all the tags\n */\nriot.mixin = (function() {\n  var mixins = {}\n\n  /**\n   * Create/Return a mixin by its name\n   * @param   { String } name - mixin name\n   * @param   { Object } mixin - mixin logic\n   * @returns { Object } the mixin logic\n   */\n  return function(name, mixin) {\n    if (!mixin) return mixins[name]\n    mixins[name] = mixin\n  }\n\n})()\n\n/**\n * Create a new riot tag implementation\n * @param   { String }   name - name/id of the new riot tag\n * @param   { String }   html - tag template\n * @param   { String }   css - custom tag css\n * @param   { String }   attrs - root tag attributes\n * @param   { Function } fn - user function\n * @returns { String } name/id of the tag just created\n */\nriot.tag = function(name, html, css, attrs, fn) {\n  if (isFunction(attrs)) {\n    fn = attrs\n    if (/^[\\w\\-]+\\s?=/.test(css)) {\n      attrs = css\n      css = ''\n    } else attrs = ''\n  }\n  if (css) {\n    if (isFunction(css)) fn = css\n    else if (injectStyle) injectStyle(css)\n  }\n  __tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\n/**\n * Create a new riot tag implementation (for use by the compiler)\n * @param   { String }   name - name/id of the new riot tag\n * @param   { String }   html - tag template\n * @param   { String }   css - custom tag css\n * @param   { String }   attrs - root tag attributes\n * @param   { Function } fn - user function\n * @param   { string }  [bpair] - brackets used in the compilation\n * @returns { String } name/id of the tag just created\n */\nriot.tag2 = function(name, html, css, attrs, fn, bpair) {\n  if (css && injectStyle) injectStyle(css)\n  //if (bpair) riot.settings.brackets = bpair\n  __tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\n/**\n * Mount a tag using a specific tag implementation\n * @param   { String } selector - tag DOM selector\n * @param   { String } tagName - tag implementation name\n * @param   { Object } opts - tag logic\n * @returns { Array } new tags instances\n */\nriot.mount = function(selector, tagName, opts) {\n\n  var els,\n    allTags,\n    tags = []\n\n  // helper functions\n\n  function addRiotTags(arr) {\n    var list = ''\n    each(arr, function (e) {\n      list += ', *[' + RIOT_TAG + '=\"' + e.trim() + '\"]'\n    })\n    return list\n  }\n\n  function selectAllTags() {\n    var keys = Object.keys(__tagImpl)\n    return keys + addRiotTags(keys)\n  }\n\n  function pushTags(root) {\n    var last\n\n    if (root.tagName) {\n      if (tagName && (!(last = getAttr(root, RIOT_TAG)) || last != tagName))\n        setAttr(root, RIOT_TAG, tagName)\n\n      var tag = mountTo(root, tagName || root.getAttribute(RIOT_TAG) || root.tagName.toLowerCase(), opts)\n\n      if (tag) tags.push(tag)\n    } else if (root.length)\n      each(root, pushTags)   // assume nodeList\n\n  }\n\n  // ----- mount code -----\n\n  if (typeof tagName === T_OBJECT) {\n    opts = tagName\n    tagName = 0\n  }\n\n  // crawl the DOM to find the tag\n  if (typeof selector === T_STRING) {\n    if (selector === '*')\n      // select all the tags registered\n      // and also the tags found with the riot-tag attribute set\n      selector = allTags = selectAllTags()\n    else\n      // or just the ones named like the selector\n      selector += addRiotTags(selector.split(','))\n\n    // make sure to pass always a selector\n    // to the querySelectorAll function\n    els = selector ? $$(selector) : []\n  }\n  else\n    // probably you have passed already a tag or a NodeList\n    els = selector\n\n  // select all the registered and mount them inside their root elements\n  if (tagName === '*') {\n    // get all custom tags\n    tagName = allTags || selectAllTags()\n    // if the root els it's just a single tag\n    if (els.tagName)\n      els = $$(tagName, els)\n    else {\n      // select all the children for all the different root elements\n      var nodeList = []\n      each(els, function (_el) {\n        nodeList.push($$(tagName, _el))\n      })\n      els = nodeList\n    }\n    // get rid of the tagName\n    tagName = 0\n  }\n\n  if (els.tagName)\n    pushTags(els)\n  else\n    each(els, pushTags)\n\n  return tags\n}\n\n/**\n * Update all the tags instances created\n * @returns { Array } all the tags instances\n */\nriot.update = function() {\n  return each(__virtualDom, function(tag) {\n    tag.update()\n  })\n}\n\n/**\n * Export the Tag constructor\n */\nriot.Tag = Tag\n  // support CommonJS, AMD & browser\n  /* istanbul ignore next */\n  if (typeof exports === T_OBJECT)\n    module.exports = riot\n  else if (typeof define === 'function' && define.amd)\n    define(function() { return (window.riot = riot) })\n  else\n    window.riot = riot\n\n})(typeof window != 'undefined' ? window : void 0);\n","var riot = require('riot');\nmodule.exports = riot.tag2('user-view', '<div class=\"view user-view\" show=\"{user}\"> <ul> <li><span class=\"label\">user:</span> {user.id}</li> <li><span class=\"label\">created:</span> {filters.fromNow(user.created)} ago</li> <li><span class=\"label\">karma:</span> {user.karma}</li> <li> <span class=\"label\">about:</span> <div class=\"about\" name=\"about\"></div> </li> </ul> <p class=\"links\"> <a href=\"https://news.ycombinator.com/submitted?id={user.id}\">submissions</a><br> <a href=\"https://news.ycombinator.com/threads?id={user.id}\">comments</a> </p> </div>', '', '', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.on('mount', function() {\n    store.fetchUser(opts.data, function (user) {\n      self.user = user\n      self.about.innerHTML = self.user.about\n      self.update()\n    })\n  })\n}, '{ }');\n","var riot = require('riot');\nmodule.exports = riot.tag2('item-view', '<div class=\"view item-view\" show=\"{items.length}\"> <item class=\"item\" each=\"{items}\" data=\"{this}\"></item> <ul class=\"poll-options\" if=\"{pollOptions}\"> <li each=\"{pollOptions}\"> <p>{text}</p> <p class=\"subtext\">{score} points</p> </li> </ul> <ul class=\"comments\"> <div each=\"{c, i in comments}\"> <comment data=\"{c}\"></comment> </div> </ul> <p show=\"{!comments.length}\">No comments yet.</p> </div>', '', '', function(opts) {\n  require('../components/item.html')\n  require('../components/comment.html')\n  var store = require('../store')\n  var self = this\n  self.items = []\n\n  this.fetchComments = function() {\n    store.fetchItems(self.items[0].kids, function (comments) {\n      self.comments = comments\n      self.update()\n    })\n  }.bind(this)\n\n  this.fetchPollOptions = function() {\n    store.fetchItems(self.items[0].parts, function (options) {\n      self.pollOptions = options\n      self.update()\n    })\n  }.bind(this)\n\n  store.fetchItem(opts.data, function (item) {\n    self.items = [ item ]\n    self.fetchComments()\n    if (item.type === 'poll') {\n      self.fetchPollOptions()\n    }\n    self.update()\n  })\n}, '{ }');\n","var riot = require('riot');\nmodule.exports = riot.tag2('news-view', '<div class=\"view news-view\" class=\"{loading: !items.length}\"> <ul> <li class=\"item\" each=\"{item, i in items}\" track-by=\"id\"> <item data=\"{item}\" index=\"{(parent.page - 1) * 30 + i + 1}\"></item> </li> </ul> <div class=\"nav\" show=\"{items.length}\"> <a if=\"{page > 1}\" href=\"#news/{page - 1}\">&lt; prev</a> <a if=\"{page < 4}\" href=\"#news/{page - -1}\">more...</a> </div> </div>', '', '', function(opts) {\n  require('../components/item.html')\n  var store = require('../store')\n  var self = this\n  self.page = opts.data\n  self.items = []\n\n  this.fetchNews = function() {\n    store.fetchItemsByPage(self.page, function (items) {\n      self.items = items\n      self.displayPage = self.page\n      self.update()\n    })\n  }.bind(this)\n\n  self.on('mount', function() {\n    self.fetchNews()\n    store.on('update', self.fetchNews)\n  })\n\n  self.on('unmount', function() {\n    store.removeListener('update', self.fetchNews)\n  })\n}, '{ }');\n","var api = new Firebase('https://hacker-news.firebaseio.com/v0')\nvar storiesPerPage = 30\nvar cachedStoryIds = []\nvar Emitter = require('events').EventEmitter\nvar store = new Emitter()\n\n/**\n * Subscribe to real time updates of the top 100 stories,\n * and cache the IDs locally.\n */\n\napi.child('topstories').on('value', function (snapshot) {\n  cachedStoryIds = snapshot.val()\n  store.emit('update')\n})\n\n/**\n * Fetch an item data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(item)\n */\n\nstore.fetchItem = function (id, cb) {\n  api.child('item/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch a user data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(user)\n */\n\nstore.fetchUser = function (id, cb) {\n  api.child('user/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch the given list of items.\n *\n * @param {Array<Number>} ids\n * @param {Function} cb(items)\n */\n\nstore.fetchItems = function (ids, cb) {\n  if (!ids || !ids.length) return cb([])\n  var items = []\n  ids.forEach(function (id) {\n    store.fetchItem(id, addItem)\n  })\n  function addItem (item) {\n    items.push(item)\n    if (items.length >= ids.length) {\n      cb(items)\n    }\n  }\n}\n\n/**\n * Fetch items for the given page.\n *\n * @param {Number} page\n * @param {Function} cb(stories)\n */\n\nstore.fetchItemsByPage = function (page, cb) {\n  var start = (page - 1) * storiesPerPage\n  var end = page * storiesPerPage\n  var ids = cachedStoryIds.slice(start, end)\n  store.fetchItems(ids, cb)\n}\n\nmodule.exports = store\n","var riot = require('riot');\nmodule.exports = riot.tag2('item', '<span class=\"index\">{opts.index}.</span> <p> <a class=\"title\" href=\"{href()}\" target=\"_blank\">{itemdata.title}</a> <span class=\"domain\" show=\"{showDomain()}\"> ({filters.domain(itemdata.url)}) </span> </p> <p class=\"subtext\"> <span show=\"{showInfo()}\"> {itemdata.score} points by <a href=\"#user/{itemdata.by}\">{itemdata.by}</a> </span> {filters.fromNow(itemdata.time)} ago <span class=\"comments-link\" show=\"{showInfo()}\"> | <a href=\"#item/{itemdata.id}\">comments</a> </span> </p>', '', '', function(opts) {\n  var self = this\n  self.itemdata = opts.data\n\n  this.href = function() {\n    return self.itemdata.url || ('#/item/' + self.itemdata.id)\n  }.bind(this)\n\n  this.showInfo = function() {\n    return self.itemdata.type === 'story' || self.itemdata.type === 'poll'\n  }.bind(this)\n\n  this.showDomain = function() {\n    return self.itemdata.type === 'story'\n  }.bind(this)\n}, '{ }');\n","var riot = require('riot');\nmodule.exports = riot.tag2('comment', '<li show=\"{data.text}\"> <div class=\"comhead\"> <a class=\"toggle\" onclick=\"{toggle}\">{open ? \\'[-]\\' : \\'[+]\\'}</a> <a href=\"#user/{data.by}\">{data.by}</a> {filters.fromNow(data.time)} ago </div> <div class=\"comment-content\" name=\"commentcontent\" show=\"{open}\"></div> <ul class=\"child-comments\" if=\"{data.kids}\" show=\"{open}\"> <div each=\"{c, i in comments}\"> <comment data=\"{c}\"></comment> <div> </ul> </li>', '', '', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.data = opts.data\n  self.open = true\n  self.commentcontent.innerHTML = self.data.text\n\n  store.fetchItems(self.data.kids, function(result) {\n    self.comments = result\n    self.update()\n  })\n\n  this.toggle = function(e) {\n    this.open = !this.open\n  }.bind(this)\n}, '{ }');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n"]}